import{r,j as e,R as ie}from"./index-DY7b8JLi.js";import{s as D}from"./supabase-DllM73rC.js";const se=r.createContext(null);async function oe(t){const{data:n,error:x}=await D.from("profiles").select("*").eq("user_id",t).maybeSingle();if(x)throw x;return n??null}function de({children:t}){const[n,x]=r.useState({user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!0,error:null}),s=r.useRef(null),i=r.useRef(null),u=r.useRef(!0),m=r.useCallback(()=>{s.current=null,i.current=null,u.current&&x({user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!1,error:null})},[]),C=r.useCallback(o=>{u.current&&x({user:o,isAuthenticated:!0,isAdmin:o.role==="admin",isLoading:!1,error:null})},[]),h=r.useCallback(async o=>{if(s.current===o&&i.current)return i.current;s.current=o;const y=(async()=>{try{return await oe(o)}catch(a){return console.error("Profile fetch error:",a),null}})();return i.current=y,y},[]);r.useEffect(()=>{u.current=!0;const o=async a=>{var f,v;if(!((f=a==null?void 0:a.user)!=null&&f.id)){m();return}if(!u.current)return;x(g=>({...g,isLoading:!0,error:null}));const d=a.user.id,j=await h(d);u.current&&s.current===d&&C(j||{id:d,user_id:d,email:a.user.email||"",full_name:((v=a.user.user_metadata)==null?void 0:v.full_name)||a.user.email||"",role:"standard",created_at:new Date().toISOString()})};D.auth.getSession().then(({data:a})=>{o(a.session)});const{data:{subscription:y}}=D.auth.onAuthStateChange((a,d)=>{o(d)});return()=>{u.current=!1,y.unsubscribe()}},[h,C,m]);const l=r.useCallback(async(o,y)=>{x(d=>({...d,isLoading:!0,error:null}));const{error:a}=await D.auth.signInWithPassword({email:o,password:y});a&&x(d=>({...d,isLoading:!1,error:a.message}))},[]),L=r.useCallback(async(o,y,a,d="standard")=>{var v;x(g=>({...g,isLoading:!0,error:null}));const{data:j,error:f}=await D.auth.signUp({email:o,password:y,options:{data:{full_name:a}}});if(f){x(g=>({...g,isLoading:!1,error:f.message}));return}(v=j.user)!=null&&v.id&&await D.from("profiles").upsert({user_id:j.user.id,email:o,full_name:a,role:d})},[]),N=r.useCallback(async()=>{await D.auth.signOut()},[]),b=r.useCallback(()=>{x(o=>({...o,error:null}))},[]);return e.jsx(se.Provider,{value:{...n,signIn:l,signUp:L,signOut:N,clearError:b},children:t})}function U(){const t=r.useContext(se);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function I(t){if(!t.test_tag_next_due)return"No Tag";const n=new Date,x=new Date(t.test_tag_next_due),s=Math.ceil((x.getTime()-n.getTime())/(1e3*60*60*24));return s<0?"Expired":s<=t.tag_threshold_days?"Due Soon":"OK"}function z(t){if(t.current_status==="Maintenance")return"Maintenance";if(t.current_status==="In Use"){if(t.expected_return_date){const n=new Date;if(new Date(t.expected_return_date)<n)return"Overdue"}return"In Use"}return"Available"}function ce(t){switch(t){case"OK":return{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200"};case"Due Soon":return{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200"};case"Expired":return{bg:"bg-red-50",text:"text-red-700",border:"border-red-200"};case"No Tag":return{bg:"bg-gray-50",text:"text-gray-500",border:"border-gray-200"}}}function xe(t){switch(t){case"Available":return{bg:"bg-emerald-50",text:"text-emerald-700",dot:"bg-emerald-500"};case"In Use":return{bg:"bg-blue-50",text:"text-blue-700",dot:"bg-blue-500"};case"Overdue":return{bg:"bg-red-50",text:"text-red-700",dot:"bg-red-500"};case"Maintenance":return{bg:"bg-orange-50",text:"text-orange-700",dot:"bg-orange-500"}}}const me=["Power Tools","Survey Equipment","Compaction","Power Supply","Cutting Equipment","Fastening Tools","Demolition","Electrical Testing","Access Equipment","General","Safety Equipment","Hand Tools"],re=r.createContext(null);function W(t,n){const x=t.toLowerCase(),s=n.toLowerCase();if(x.includes(s))return!0;let i=0;for(let u=0;u<x.length&&i<s.length;u++)x[u]===s[i]&&i++;return i===s.length}function ue({children:t}){const[n,x]=r.useState([]),[s,i]=r.useState([]),[u,m]=r.useState(!0),[C,h]=r.useState(null),[l,L]=r.useState(""),[N,b]=r.useState("All"),[o,y]=r.useState(null),a=r.useCallback(async()=>{m(!0),h(null);const c=new AbortController,p=setTimeout(()=>c.abort(),12e3);try{const[w,E]=await Promise.all([D.from("equipment").select("*").order("asset_id",{ascending:!0}).abortSignal(c.signal),D.from("movements").select("*").order("event_timestamp",{ascending:!1}).abortSignal(c.signal)]);if(clearTimeout(p),w.error)throw w.error;if(E.error)throw E.error;const T=(w.data||[]).map(B=>({...B,current_status:z(B)}));x(T),i(E.data||[])}catch(w){w.name==="AbortError"?h("Request timed out. Please try again."):h(w.message||"Failed to load data")}finally{m(!1)}},[]);r.useEffect(()=>{a()},[a]);const d=r.useMemo(()=>{const c={total:0,available:0,inUse:0,overdue:0,expiredTags:0,dueSoon:0};return n.forEach(p=>{c.total++;const w=z(p);w==="Available"&&c.available++,w==="In Use"&&c.inUse++,w==="Overdue"&&c.overdue++;const E=I(p);E==="Expired"&&c.expiredTags++,E==="Due Soon"&&c.dueSoon++}),c},[n]),j=r.useMemo(()=>{let c=n;switch(N){case"Available":c=c.filter(p=>z(p)==="Available");break;case"In Use":c=c.filter(p=>z(p)==="In Use");break;case"Overdue":c=c.filter(p=>z(p)==="Overdue");break;case"Expired Tags":c=c.filter(p=>I(p)==="Expired");break;case"Due Soon":c=c.filter(p=>I(p)==="Due Soon");break}return l.trim()&&(c=c.filter(p=>W(p.name,l)||W(p.asset_id,l)||W(p.category,l)||W(p.assigned_to||"",l)||W(p.assigned_site||"",l))),c},[n,N,l]),f=r.useMemo(()=>o&&n.find(c=>c.id===o)||null,[o,n]),v=r.useMemo(()=>o?s.filter(c=>c.equipment_id===o):[],[o,s]),g=r.useCallback(c=>{y(c)},[]),_=r.useCallback(async c=>{try{const{data:p,error:w}=await D.from("equipment").insert(c).select().single();if(w)throw w;return await a(),p}catch(p){return h(p.message),null}},[a]),M=r.useCallback(async(c,p)=>{try{const{error:w}=await D.from("equipment").update({...p,updated_at:new Date().toISOString()}).eq("id",c);if(w)throw w;return await a(),!0}catch(w){return h(w.message),!1}},[a]),A=r.useCallback(async c=>{try{const{error:p}=await D.from("movements").insert(c);if(p)throw p;const w={};if(c.event_type==="check_out"?(w.current_status="In Use",w.assigned_to=c.assigned_to||"",w.assigned_site=c.site||"",w.assigned_job=c.job_reference||"",w.expected_return_date=c.expected_return_date||null):c.event_type==="return"&&(w.current_status="Available",w.assigned_to="",w.assigned_site="",w.assigned_job="",w.expected_return_date=null),c.equipment_id){const{error:E}=await D.from("equipment").update({...w,updated_at:new Date().toISOString()}).eq("id",c.equipment_id);if(E)throw E}return await a(),!0}catch(p){return h(p.message),!1}},[a]),S=r.useCallback(async(c,p)=>{try{const{error:w}=await D.storage.from("equipment-photos").upload(p,c,{upsert:!0});if(w)throw w;const{data:E}=D.storage.from("equipment-photos").getPublicUrl(p);return E.publicUrl}catch(w){return h(w.message),null}},[]);return e.jsx(re.Provider,{value:{equipment:n,movements:s,isLoading:u,error:C,searchQuery:l,activeFilter:N,filteredEquipment:j,stats:d,selectedEquipment:f,selectedMovements:v,setSearchQuery:L,setActiveFilter:b,selectEquipment:g,refreshData:a,createEquipment:_,updateEquipment:M,createMovement:A,uploadPhoto:S},children:t})}function R(){const t=r.useContext(re);if(!t)throw new Error("useEquipment must be used within EquipmentProvider");return t}function K({onOpenAuth:t,currentView:n,onScanResult:x,onToggleSidebar:s}){var N;const{user:i,isAdmin:u,setDemoRole:m,signOut:C}=U(),[h,l]=r.useState(!1),L={dashboard:"Dashboard",equipment:"Equipment Registry",detail:"Equipment Detail"};return e.jsx("header",{className:"sticky top-0 z-20 bg-slate-900/70 backdrop-blur-xl ring-1 ring-white/10",children:e.jsxs("div",{className:"px-4 lg:px-6 h-16 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{type:"button","aria-label":"Open menu",onClick:()=>s==null?void 0:s(),className:"lg:hidden inline-flex items-center justify-center rounded-lg border border-slate-700 bg-slate-800 p-2 text-slate-300 hover:bg-slate-700 transition-colors",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("h1",{className:"text-lg font-semibold text-slate-100 truncate",children:L[n]||"Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{className:"hidden sm:inline-flex items-center gap-2 px-3 py-2 bg-amber-500 hover:bg-amber-600 text-black rounded-lg text-xs font-semibold transition-colors",children:"Scan QR"}),e.jsxs("div",{className:"hidden md:flex items-center bg-slate-800 rounded-lg p-0.5 border border-slate-700",children:[e.jsx("button",{onClick:()=>m("admin"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-all ${u?"bg-slate-700 text-white":"text-slate-400 hover:text-white"}`,children:"Admin"}),e.jsx("button",{onClick:()=>m("standard"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-all ${u?"text-slate-400 hover:text-white":"bg-slate-700 text-white"}`,children:"Standard"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>l(!h),className:"flex items-center gap-2 rounded-lg px-2 py-1.5 hover:bg-slate-800 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center text-white text-sm font-semibold",children:((N=i==null?void 0:i.full_name)==null?void 0:N.charAt(0))||"U"}),e.jsx("span",{className:"hidden lg:block text-sm text-slate-300",children:(i==null?void 0:i.full_name)||"User"})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-slate-800 border border-slate-700 rounded-xl shadow-xl z-40 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700",children:[e.jsx("p",{className:"text-sm font-medium text-slate-100",children:i==null?void 0:i.full_name}),e.jsx("p",{className:"text-xs text-slate-400",children:i==null?void 0:i.email})]}),e.jsx("button",{onClick:()=>{t(),l(!1)},className:"w-full text-left px-4 py-2 text-sm text-slate-300 hover:bg-slate-700 transition-colors",children:"Account"}),e.jsx("button",{onClick:()=>{C(),l(!1)},className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors",children:"Sign Out"})]})]})]})]})]})})}function X({currentView:t,onNavigate:n,collapsed:x,onToggle:s}){const{stats:i}=R(),u="/long-line-tracker-v2/LLT-developer-logo.png",m=[{id:"dashboard",label:"Dashboard",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})})},{id:"equipment",label:"Equipment",badge:i.total,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17l-5.384-3.19A2.625 2.625 0 015.25 9.75V6.375a2.625 2.625 0 012.786-2.619l5.384.319M11.42 15.17l5.384 3.19A2.625 2.625 0 0017.25 16.5V6.375a2.625 2.625 0 00-2.786-2.619l-5.384.319M11.42 15.17V20.25"})})}],C=[{label:"Overdue",count:i.overdue,color:"bg-red-500"},{label:"Expired Tags",count:i.expiredTags,color:"bg-red-400"},{label:"Due Soon",count:i.dueSoon,color:"bg-amber-500"}],h=l=>t===l||l==="equipment"&&t==="detail";return e.jsxs("aside",{className:`${x?"w-16":"w-64"} h-screen flex flex-col transition-[width] duration-300
        bg-slate-900/35 backdrop-blur-xl ring-1 ring-white/10`,children:[e.jsxs("div",{className:"h-16 flex items-center gap-3 px-4 border-b border-white/10",children:[e.jsx("img",{src:u,alt:"Long Line Tracker",className:"w-10 h-10 object-contain",draggable:!1}),!x&&e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-white font-semibold leading-tight",children:"Long Line"}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium tracking-wider uppercase",children:"Tracker v2"})]})]}),e.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:m.map(l=>e.jsxs("button",{onClick:()=>n(l.id),title:x?l.label:void 0,className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-colors ${h(l.id)?"bg-amber-500/15 text-amber-200 ring-1 ring-amber-400/15":"text-slate-300 hover:text-white hover:bg-white/5"}`,children:[e.jsx("span",{className:"shrink-0",children:l.icon}),!x&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1 text-left truncate",children:l.label}),typeof l.badge=="number"&&e.jsx("span",{className:"bg-white/10 text-slate-200 text-xs px-2 py-0.5 rounded-full",children:l.badge})]})]},l.id))}),!x&&e.jsx("div",{className:"px-3 pb-4",children:e.jsxs("div",{className:"bg-white/5 rounded-xl p-3 ring-1 ring-white/10",children:[e.jsx("p",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wider mb-2",children:"Alerts"}),e.jsx("div",{className:"space-y-2",children:C.map(l=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-300",children:l.label}),e.jsx("span",{className:`${l.color} text-white text-xs font-bold px-1.5 py-0.5 rounded`,children:l.count})]},l.label))})]})}),e.jsx("button",{onClick:s,className:"h-12 flex items-center justify-center border-t border-white/10 text-slate-300 hover:text-white hover:bg-white/5 transition-colors",title:x?"Expand":"Collapse",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${x?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"})})})]})}const k={shell:"text-white bg-gradient-to-b from-[#050A12] via-[#0B1626] to-[#071A2E]",card:"rounded-2xl bg-slate-800/50 backdrop-blur-md ring-1 ring-white/5 shadow-[0_12px_35px_rgba(0,0,0,0.35)]",cardHover:"transition-colors hover:bg-slate-800/60 hover:ring-white/10",cardPad:"p-4 md:p-6",divider:"border-white/10",input:"bg-slate-900/40 text-white placeholder:text-slate-500 border-white/10 focus-visible:ring-2 focus-visible:ring-amber-500/40 focus-visible:ring-offset-0"};function Y({onNavigate:t}){const{stats:n,equipment:x,movements:s,isLoading:i}=R();if(i)return e.jsx("div",{className:"text-slate-400",children:"Loading..."});const u=[{label:"Total Equipment",value:n.total,filter:"All"},{label:"Available",value:n.available,filter:"Available"},{label:"In Use",value:n.inUse,filter:"In Use"},{label:"Overdue",value:n.overdue,filter:"Overdue"},{label:"Expired Tags",value:n.expiredTags,filter:"Expired Tags"},{label:"Due Soon",value:n.dueSoon,filter:"Due Soon"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-6 gap-4",children:u.map(m=>e.jsxs("button",{onClick:()=>t("equipment",m.filter),className:`${k.card} ${k.cardHover} p-5 text-left transition-all`,children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:m.value}),e.jsx("p",{className:"text-xs text-slate-400 mt-1 font-medium tracking-wide",children:m.label})]},m.label))}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`xl:col-span-2 ${k.card}`,children:[e.jsx("div",{className:`px-5 py-4 border-b ${k.divider} flex items-center justify-between`,children:e.jsx("h3",{className:"font-semibold text-white",children:"Recent Activity"})}),e.jsx("div",{className:"divide-y divide-slate-700/40",children:s.length===0?e.jsx("div",{className:"p-6 text-sm text-slate-500 text-center",children:"No recent activity"}):s.slice(0,8).map(m=>e.jsxs("div",{className:"px-5 py-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-200",children:m.event_type==="check_out"?"Checked Out":"Returned"}),e.jsx("p",{className:"text-xs text-slate-500",children:new Date(m.event_timestamp).toLocaleDateString()})]}),e.jsx("span",{className:"text-xs text-slate-400",children:m.assigned_to})]},m.id))})]}),e.jsxs("div",{className:`${k.card}`,children:[e.jsx("div",{className:`px-5 py-4 border-b ${k.divider}`,children:e.jsx("h3",{className:"font-semibold text-white",children:"Compliance Summary"})}),e.jsxs("div",{className:"p-5 space-y-4 text-sm text-slate-300",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Compliant"}),e.jsx("span",{children:x.filter(m=>I(m)==="OK").length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Due Soon"}),e.jsx("span",{children:n.dueSoon})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Expired"}),e.jsx("span",{className:"text-red-400",children:n.expiredTags})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"No Tag"}),e.jsx("span",{children:x.filter(m=>I(m)==="No Tag").length})]})]})]})]})]})}function H({status:t}){const n=xe(t);return e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold ${n.bg} ${n.text}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${n.dot}`}),t]})}function V({state:t}){const n=ce(t);return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium border ${n.bg} ${n.text} ${n.border}`,children:[t==="OK"&&e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t==="Due Soon"&&e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),t==="Expired"&&e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126z"})}),"Tag: ",t]})}function he({condition:t}){const n={New:"bg-indigo-50 text-indigo-700",Good:"bg-green-50 text-green-700",Fair:"bg-yellow-50 text-yellow-700",Poor:"bg-orange-50 text-orange-700",Damaged:"bg-red-50 text-red-700"};return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${n[t]||"bg-slate-900/40 text-slate-300"}`,children:t})}const pe=["All","Available","In Use","Overdue","Expired Tags","Due Soon"];function Z({onSelectEquipment:t,onCreateNew:n,onImport:x,initialFilter:s}){const{filteredEquipment:i,searchQuery:u,setSearchQuery:m,activeFilter:C,setActiveFilter:h,stats:l,isLoading:L}=R(),{isAdmin:N}=U(),[b,o]=r.useState("grid");ie.useEffect(()=>{s&&h(s)},[s,h]);const y={All:l.total,Available:l.available,"In Use":l.inUse,Overdue:l.overdue,"Expired Tags":l.expiredTags,"Due Soon":l.dueSoon};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:`px-6 py-4 ${k.card} ${k.cardPad} space-y-4`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),e.jsx("input",{type:"text",value:u,onChange:a=>m(a.target.value),placeholder:"Search equipment, asset ID, category...",className:`w-full pl-10 pr-4 py-2.5 rounded-lg text-sm focus:outline-none border ${k.input}`}),u&&e.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center bg-slate-900/30 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>o("grid"),className:`p-2 rounded-md transition-all ${b==="grid"?"bg-slate-800/60 ring-1 ring-white/10 text-white":"text-slate-400"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})})}),e.jsx("button",{onClick:()=>o("table"),className:`p-2 rounded-md transition-all ${b==="table"?"bg-slate-800/60 ring-1 ring-white/10 text-white":"text-slate-400"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"})})})]}),N&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:x,className:"px-3 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-slate-900/40 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),"Import"]}),e.jsxs("button",{onClick:n,className:"px-4 py-2.5 bg-amber-500/90 text-slate-950 rounded-lg text-sm font-semibold hover:bg-amber-500 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Add Equipment"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto pb-1",children:pe.map(a=>e.jsxs("button",{onClick:()=>h(a),className:`px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap transition-all ${C===a?"bg-amber-500/25 text-amber-200 ring-1 ring-amber-400/20":"text-slate-400 hover:text-slate-200 hover:bg-slate-900/30"}`,children:[a,e.jsx("span",{className:`ml-1.5 text-xs ${C===a?"text-white/70":"text-slate-400"}`,children:y[a]})]},a))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[L?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[...Array(6)].map((a,d)=>e.jsxs("div",{className:"bg-slate-800/50 rounded-2xl p-5 ring-1 ring-white/5 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-white/10 rounded w-1/2 mb-4"}),e.jsx("div",{className:"h-6 bg-white/10 rounded w-20"})]},d))}):i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400",children:[e.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})}),e.jsx("p",{className:"text-lg font-medium mb-1",children:"No equipment found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filter criteria"})]}):b==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:i.map(a=>e.jsx(ge,{equipment:a,onClick:()=>t(a.id),isAdmin:N},a.id))}):e.jsx(fe,{equipment:i,onSelect:t,isAdmin:N}),!L&&i.length>0&&e.jsxs("p",{className:"text-xs text-slate-400 mt-4 text-center",children:["Showing ",i.length," of ",l.total," items"]})]})]})}function ge({equipment:t,onClick:n,isAdmin:x}){const s=z(t),i=I(t);return e.jsxs("button",{onClick:n,className:`p-5 text-left group w-full ${k.card} ${k.cardHover}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-mono text-slate-400 bg-slate-900/40 px-1.5 py-0.5 rounded",children:t.asset_id}),e.jsx("span",{className:"text-xs text-slate-400",children:t.category})]}),e.jsx("h3",{className:"text-sm font-semibold text-white truncate group-hover:text-amber-300 transition-colors",children:t.name})]}),e.jsx("svg",{className:"w-4 h-4 text-slate-500 group-hover:text-slate-400 flex-shrink-0 mt-1 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(H,{status:s}),e.jsx(V,{state:i})]}),t.test_tag_next_due&&e.jsxs("p",{className:"text-xs text-slate-400 mb-2",children:["Next test: ",new Date(t.test_tag_next_due).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})]}),s!=="Available"&&t.assigned_to&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),e.jsx("span",{className:"text-slate-300 font-medium",children:t.assigned_to})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),e.jsx("span",{className:"text-slate-400",children:t.assigned_site})]}),t.expected_return_date&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})}),e.jsxs("span",{className:`${new Date(t.expected_return_date)<new Date?"text-red-500 font-medium":"text-slate-400"}`,children:["Due: ",new Date(t.expected_return_date).toLocaleDateString("en-AU",{day:"numeric",month:"short"})]})]})]})]})}function fe({equipment:t,onSelect:n,isAdmin:x}){return e.jsx("div",{className:`overflow-hidden ${k.card}`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b ${k.divider}`,children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Asset"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Tag"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Assigned To"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Site"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Next Test"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:t.map(s=>{const i=z(s),u=I(s);return e.jsxs("tr",{onClick:()=>n(s.id),className:"hover:bg-slate-900/40 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.name}),e.jsx("p",{className:"text-xs text-slate-400 font-mono",children:s.asset_id})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-300",children:s.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(H,{status:i})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(V,{state:u})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-300",children:s.assigned_to||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-300",children:s.assigned_site||"-"}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-400",children:s.test_tag_next_due?new Date(s.test_tag_next_due).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"}):"-"})]},s.id)})})]})})})}function ee({onBack:t,onEdit:n,onMovement:x}){const{selectedEquipment:s,selectedMovements:i}=R(),{isAdmin:u}=U(),[m,C]=r.useState(!1);if(!s)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-slate-400",children:"Equipment not found"})});const h=z(s),l=I(s),L=s.test_tag_next_due_date??s.test_tag_next_due??null,N=L?Math.ceil((new Date(L).getTime()-new Date().getTime())/(1e3*60*60*24)):null,b=s.qr_code,o=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(b)}&color=1e3a5f&bgcolor=ffffff&margin=8`,y=`https://api.qrserver.com/v1/create-qr-code/?size=600x600&data=${encodeURIComponent(b)}&color=1e3a5f&bgcolor=ffffff&margin=16`,a=u&&(h==="Available"||h==="In Use"||h==="Overdue"),d=h==="Available",j=d?"Check Out":"Return";return e.jsxs("div",{className:"h-full overflow-y-auto overflow-x-hidden",children:[e.jsx("div",{className:`px-4 sm:px-6 py-3 sm:py-4 ${k.card} ${k.cardPad}`,children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 min-w-0",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-900/30 rounded-lg transition-colors text-slate-400 hover:text-slate-300 shrink-0","aria-label":"Back",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-xs font-mono text-slate-400 bg-slate-900/30 px-2 py-0.5 rounded",children:s.asset_id}),e.jsx(H,{status:h}),e.jsx(V,{state:l})]}),e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-white mt-1 truncate",children:s.name})]})]}),e.jsxs("div",{className:"w-full sm:w-auto flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end sm:gap-2",children:[a&&e.jsxs("button",{onClick:()=>x(d?"check_out":"return"),className:`w-full sm:w-auto px-4 py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2 ${d?"bg-amber-500/90 text-slate-950 hover:bg-amber-500":"bg-emerald-600 text-white hover:bg-emerald-700"}`,children:[d?e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 4.5l-15 15m0 0h11.25m-11.25 0V8.25"})}),j]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>C(!m),className:`flex-1 sm:flex-none p-2.5 border rounded-lg transition-colors ${m?"bg-amber-500/90 text-slate-950 border-amber-400/30":"border-white/10 text-slate-300 hover:bg-slate-900/30"}`,title:"Show QR Code","aria-label":"Show QR Code",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 013.75 9.375v-4.5zM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 01-1.125-1.125v-4.5zM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0113.5 9.375v-4.5z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75zM6.75 16.5h.75v.75h-.75v-.75zM16.5 6.75h.75v.75h-.75v-.75zM13.5 13.5h.75v.75h-.75v-.75zM13.5 19.5h.75v.75h-.75v-.75zM19.5 13.5h.75v.75h-.75v-.75zM19.5 19.5h.75v.75h-.75v-.75zM16.5 16.5h.75v.75h-.75v-.75z"})]})}),u&&e.jsxs("button",{onClick:n,className:"flex-1 sm:flex-none px-4 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-slate-900/30 transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),"Edit"]})]})]})]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[m&&e.jsx("div",{className:`${k.card} ${k.cardPad}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsx("div",{className:"bg-slate-900/30 p-3 rounded-2xl ring-1 ring-white/10",children:e.jsx("img",{src:o,alt:`QR Code for ${s.asset_id}`,width:200,height:200,className:"block"})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-1",children:"Equipment QR Code"}),e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Scan this code to quickly access this equipment's detail page."}),e.jsx("p",{className:"text-xs font-mono text-slate-400 bg-slate-900/30 inline-block px-2 py-1 rounded mb-4",children:s.qr_code}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center sm:justify-start",children:[e.jsxs("a",{href:y,download:`${s.asset_id}-qr.png`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-2 bg-amber-500/90 text-slate-950 rounded-lg text-xs font-medium hover:bg-amber-500 transition-colors",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"Download PNG"]}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.qr_code)},className:"inline-flex items-center gap-1.5 px-3 py-2 border border-white/10 rounded-lg text-xs font-medium text-slate-200 hover:bg-slate-900/30 transition-colors",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9.75a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})}),"Copy Code"]}),e.jsxs("button",{onClick:()=>{const f=window.open("","_blank","width=400,height=500");f&&(f.document.write(`
                          <html><head><title>QR - ${s.asset_id}</title>
                          <style>body{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;margin:0}
                          img{margin-bottom:16px}h2{margin:0;font-size:18px}p{margin:4px 0;color:#666;font-size:13px}</style></head>
                          <body><img src="${y}" width="250" height="250"/>
                          <h2>${s.asset_id}</h2><p>${s.name}</p>
                          <script>setTimeout(()=>{window.print();},500)<\/script></body></html>
                        `),f.document.close())},className:"inline-flex items-center gap-1.5 px-3 py-2 border border-white/10 rounded-lg text-xs font-medium text-slate-200 hover:bg-slate-900/30 transition-colors",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.25A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 011.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"})}),"Print Label"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:`${k.card} p-5`,children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-4",children:"Equipment Details"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Category"}),e.jsx("dd",{className:"text-sm text-white mt-0.5",children:s.category})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Condition"}),e.jsx("dd",{className:"mt-0.5",children:e.jsx(he,{condition:s.condition})})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"QR Code"}),e.jsx("dd",{className:"text-sm text-white font-mono mt-0.5",children:s.qr_code})]}),s.notes&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Notes"}),e.jsx("dd",{className:"text-sm text-slate-300 mt-0.5",children:s.notes})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Created"}),e.jsx("dd",{className:"text-sm text-slate-300 mt-0.5",children:new Date(s.created_at).toLocaleDateString("en-AU",{day:"numeric",month:"long",year:"numeric"})})]})]})]}),e.jsxs("div",{className:`${k.card} p-5`,children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-4",children:"Test & Tag Compliance"}),e.jsx("div",{className:`p-4 rounded-lg mb-4 ${l==="OK"?"bg-emerald-50":l==="Due Soon"?"bg-amber-50":l==="Expired"?"bg-red-500/10 ring-1 ring-red-500/20":"bg-slate-900/30 ring-1 ring-white/10"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{state:l}),N!==null&&e.jsx("span",{className:`text-sm font-bold ${N<0?"text-red-600":N<=30?"text-amber-600":"text-emerald-600"}`,children:N<0?`${Math.abs(N)}d overdue`:`${N}d remaining`})]})}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Last Test"}),e.jsx("dd",{className:"text-sm text-white mt-0.5",children:s.test_tag_done_date?new Date(s.test_tag_done_date).toLocaleDateString("en-AU",{day:"numeric",month:"long",year:"numeric"}):"Not recorded"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Next Due"}),e.jsx("dd",{className:"text-sm text-white mt-0.5",children:L?new Date(L).toLocaleDateString("en-AU",{day:"numeric",month:"long",year:"numeric"}):"Not scheduled"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Threshold"}),e.jsxs("dd",{className:"text-sm text-slate-300 mt-0.5",children:[s.tag_threshold_days," days"]})]})]})]}),(h==="In Use"||h==="Overdue")&&e.jsxs("div",{className:`${k.card} p-5`,children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-4",children:"Current Assignment"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Assigned To"}),e.jsx("dd",{className:"text-sm text-white font-medium mt-0.5",children:s.assigned_to})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Site"}),e.jsx("dd",{className:"text-sm text-white mt-0.5",children:s.assigned_site})]}),s.assigned_job&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Job Reference"}),e.jsx("dd",{className:"text-sm text-white font-mono mt-0.5",children:s.assigned_job})]}),s.expected_return_date&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Expected Return"}),e.jsxs("dd",{className:`text-sm font-medium mt-0.5 ${new Date(s.expected_return_date)<new Date?"text-red-600":"text-white"}`,children:[new Date(s.expected_return_date).toLocaleDateString("en-AU",{day:"numeric",month:"long",year:"numeric"}),new Date(s.expected_return_date)<new Date&&" (OVERDUE)"]})]})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:`${k.card}`,children:[e.jsxs("div",{className:`px-5 py-4 border-b ${k.divider} flex items-center justify-between`,children:[e.jsx("h3",{className:"font-semibold text-white",children:"Movement History"}),e.jsxs("span",{className:"text-xs text-slate-400",children:[i.length," entries"]})]}),i.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm",children:"No movement history recorded"})]}):e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-px bg-white/10"}),e.jsx("div",{className:"space-y-6",children:i.map(f=>e.jsxs("div",{className:"relative pl-10",children:[e.jsx("div",{className:`absolute left-2 top-1 w-4 h-4 rounded-full border-2 border-white ${f.event_type==="check_out"?"bg-blue-500":"bg-emerald-500"}`}),e.jsxs("div",{className:"bg-slate-800/40 rounded-xl p-4 ring-1 ring-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold ${f.event_type==="check_out"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"}`,children:f.event_type==="check_out"?"Check Out":"Return"}),e.jsx("span",{className:"text-xs text-slate-400",children:new Date(f.event_timestamp).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[f.assigned_to&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Person"}),e.jsx("p",{className:"text-white font-medium",children:f.assigned_to})]}),f.site&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Site"}),e.jsx("p",{className:"text-white",children:f.site})]}),f.job_reference&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Job Ref"}),e.jsx("p",{className:"text-white font-mono text-xs",children:f.job_reference})]}),f.expected_return_date&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Expected Return"}),e.jsx("p",{className:"text-white",children:new Date(f.expected_return_date).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})})]})]}),f.notes&&e.jsx("p",{className:"text-sm text-slate-300 mt-2 pt-2 border-t border-white/10",children:f.notes}),(f.pickup_photo_url||f.return_photo_url)&&e.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-white/10",children:[f.pickup_photo_url&&e.jsx("a",{href:f.pickup_photo_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline",children:"Pickup Photo"}),f.return_photo_url&&e.jsx("a",{href:f.return_photo_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline",children:"Return Photo"})]}),e.jsxs("p",{className:"text-[10px] text-slate-400 mt-2",children:["Recorded by: ",f.created_by||"System"]})]})]},f.id))})]})})]})})]})]})]})}const be=["New","Good","Fair","Poor","Damaged"];function je({equipment:t,onClose:n,onSuccess:x}){const{createEquipment:s,updateEquipment:i}=R(),[u,m]=r.useState(!1),[C,h]=r.useState({}),[l,L]=r.useState(null),N=!!t,[b,o]=r.useState({asset_id:"",name:"",category:"General",condition:"Good",notes:"",test_tag_done_date:"",test_tag_next_due:"",tag_threshold_days:30});r.useEffect(()=>{t&&o({asset_id:t.asset_id,name:t.name,category:t.category,condition:t.condition,notes:t.notes||"",test_tag_done_date:t.test_tag_done_date||"",test_tag_next_due:t.test_tag_next_due_date||t.test_tag_next_due||"",tag_threshold_days:t.tag_threshold_days??30})},[t]);const y=()=>{const d={};return b.asset_id.trim()||(d.asset_id="Asset ID is required"),b.name.trim()||(d.name="Name is required"),b.category||(d.category="Category is required"),h(d),Object.keys(d).length===0},a=async d=>{if(d.preventDefault(),L(null),!!y()){m(!0);try{if(N&&t){const j={asset_id:b.asset_id,name:b.name,category:b.category,condition:b.condition,test_tag_done_date:b.test_tag_done_date||null,test_tag_next_due_date:b.test_tag_next_due||null};await i(t.id,j)?x():L("Update failed. Check console/network and try again.")}else{const j=`QR-${b.asset_id}`,f={asset_id:b.asset_id,name:b.name,category:b.category,condition:b.condition,qr_code:j,test_tag_done_date:b.test_tag_done_date||null,test_tag_next_due_date:b.test_tag_next_due||null,current_status:"Available"};await s(f)?x():L("Create failed. Check console/network and try again.")}}catch(j){console.error("Equipment form error:",j),L((j==null?void 0:j.message)||"Unexpected error creating/updating equipment.")}finally{m(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`${k.card} w-full max-w-lg max-h-[90vh] overflow-y-auto`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${k.divider} flex items-center justify-between`,children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:N?"Edit Equipment":"Add New Equipment"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:a,className:"p-6 space-y-4",children:[l&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:l}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:["Asset ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:b.asset_id,onChange:d=>o(j=>({...j,asset_id:d.target.value})),placeholder:"e.g., TT-0025",disabled:N,className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-/20 focus:border- ${C.asset_id?"border-red-500/40 bg-red-500/10":"border-white/10"} ${N?"bg-slate-900/40 text-slate-400":""}`}),C.asset_id&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:C.asset_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:b.category,onChange:d=>o(j=>({...j,category:d.target.value})),className:`w-full px-3 py-2.5 rounded-lg text-sm focus:outline-none border ${k.input}`,children:me.map(d=>e.jsx("option",{value:d,children:d},d))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:["Equipment Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:b.name,onChange:d=>o(j=>({...j,name:d.target.value})),placeholder:"e.g., Hilti TE 70-ATC Rotary Hammer",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-/20 focus:border- ${C.name?"border-red-500/40 bg-red-500/10":"border-white/10"}`}),C.name&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:C.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Condition"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:be.map(d=>e.jsx("button",{type:"button",onClick:()=>o(j=>({...j,condition:d})),className:`px-3 py-1.5 rounded-lg text-xs font-medium border transition-all ${b.condition===d?"bg-amber-500/15 text-amber-200 ring-1 ring-amber-400/20 border-transparent":"border-white/10 text-slate-300 hover:border-white/20"}`,children:d},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Notes (local only for now)"}),e.jsx("textarea",{value:b.notes,onChange:d=>o(j=>({...j,notes:d.target.value})),rows:2,placeholder:"Equipment description or notes...",className:"w-full px-3 py-2.5 border border-white/10 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-/20 focus:border- resize-none"})]}),e.jsxs("div",{className:`border-t ${k.divider} pt-4`,children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Test & Tag Compliance"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Last Test Date"}),e.jsx("input",{type:"date",value:b.test_tag_done_date,onChange:d=>o(j=>({...j,test_tag_done_date:d.target.value})),className:`w-full px-3 py-2.5 rounded-lg text-sm focus:outline-none border ${k.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Next Due Date"}),e.jsx("input",{type:"date",value:b.test_tag_next_due,onChange:d=>o(j=>({...j,test_tag_next_due:d.target.value})),className:`w-full px-3 py-2.5 rounded-lg text-sm focus:outline-none border ${k.input}`})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Due Soon Threshold (days) (local only for now)"}),e.jsx("input",{type:"number",value:b.tag_threshold_days,onChange:d=>o(j=>({...j,tag_threshold_days:parseInt(d.target.value)||30})),min:1,max:365,className:"w-32 px-3 py-2.5 border border-white/10 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-/20 focus:border-"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-slate-900/40 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 px-4 py-2.5 bg-amber-500/90 text-slate-950 rounded-lg text-sm font-semibold hover:bg-amber-500 transition-colors disabled:opacity-50",children:u?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Saving..."]}):N?"Update Equipment":"Create Equipment"})]})]})]})})}function ve({equipmentId:t,equipmentName:n,eventType:x,onClose:s,onSuccess:i}){const{createMovement:u,uploadPhoto:m}=R(),{user:C}=U(),[h,l]=r.useState(!1),[L,N]=r.useState({}),b=r.useRef(null),[o,y]=r.useState({assigned_to:"",site:"",job_reference:"",notes:"",expected_return_date:""}),[a,d]=r.useState(null),j=()=>{const g={};return x==="check_out"&&(o.assigned_to.trim()||(g.assigned_to="Assigned to is required for check-out"),o.site.trim()||(g.site="Site is required for check-out")),N(g),Object.keys(g).length===0},f=async g=>{if(g.preventDefault(),!!j()){l(!0);try{let _="";if(a){const S=`movements/${t}/${Date.now()}-${a.name}`,c=await m(a,S);c&&(_=c)}const M={equipment_id:t,event_type:x,event_timestamp:new Date().toISOString(),assigned_to:o.assigned_to,site:o.site,job_reference:o.job_reference,notes:o.notes,created_by:(C==null?void 0:C.email)||"system"};x==="check_out"?(M.expected_return_date=o.expected_return_date||null,_&&(M.pickup_photo_url=_)):_&&(M.return_photo_url=_),await u(M)&&i()}catch(_){console.error("Movement error:",_)}finally{l(!1)}}},v=x==="check_out";return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`${k.card} w-full max-w-lg max-h-[90vh] overflow-y-auto`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${k.divider} flex items-center justify-between ${v?"bg-blue-50":"bg-emerald-50"}`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold ${v?"text-blue-900":"text-emerald-900"}`,children:v?"Check Out Equipment":"Return Equipment"}),e.jsx("p",{className:"text-sm text-slate-300 mt-0.5",children:n})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[v&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:["Assigned To ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.assigned_to,onChange:g=>y(_=>({..._,assigned_to:g.target.value})),placeholder:"Person name",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2  ${L.assigned_to?"border-red-500/40 bg-red-500/10":"border-white/10"}`}),L.assigned_to&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:L.assigned_to})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:["Site ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.site,onChange:g=>y(_=>({..._,site:g.target.value})),placeholder:"Site name or location",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none focus:ring-2  ${L.site?"border-red-500/40 bg-red-500/10":"border-white/10"}`}),L.site&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:L.site})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Job Reference"}),e.jsx("input",{type:"text",value:o.job_reference,onChange:g=>y(_=>({..._,job_reference:g.target.value})),placeholder:"e.g., JOB-2024-001",className:"w-full px-3 py-2.5 border border-white/10 rounded-lg text-sm focus:outline-none focus:ring-2 "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Expected Return Date"}),e.jsx("input",{type:"date",value:o.expected_return_date,onChange:g=>y(_=>({..._,expected_return_date:g.target.value})),className:"w-full px-3 py-2.5 border border-white/10 rounded-lg text-sm focus:outline-none focus:ring-2 "})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Notes"}),e.jsx("textarea",{value:o.notes,onChange:g=>y(_=>({..._,notes:g.target.value})),rows:3,placeholder:"Add any relevant notes...",className:"w-full px-3 py-2.5 border border-white/10 rounded-lg text-sm focus:outline-none focus:ring-2  resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:v?"Pickup Photo":"Return Photo"}),e.jsx("div",{onClick:()=>{var g;return(g=b.current)==null?void 0:g.click()},className:"border-2 border-dashed border-white/10 rounded-lg p-4 text-center cursor-pointer hover:border-white/20 transition-colors",children:a?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm text-slate-200",children:a.name}),e.jsx("button",{type:"button",onClick:g=>{g.stopPropagation(),d(null)},className:"text-slate-400 hover:text-red-500",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-8 h-8 text-white/20 mx-auto mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0z"})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Click to upload photo"})]})}),e.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:g=>{var _;return d(((_=g.target.files)==null?void 0:_[0])||null)},className:"hidden"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-white/5 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:`flex-1 px-4 py-2.5 rounded-lg text-sm font-medium text-white transition-colors disabled:opacity-50 ${v?"bg-amber-500/90 hover:bg-amber-500 text-slate-950 font-semibold":"bg-emerald-600 hover:bg-emerald-700"}`,children:h?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Processing..."]}):v?"Confirm Check Out":"Confirm Return"})]})]})]})})}function we({onClose:t,onSuccess:n}){const{createEquipment:x,equipment:s}=R(),i=r.useRef(null),[u,m]=r.useState("upload"),[C,h]=r.useState([]),[l,L]=r.useState(0),[N,b]=r.useState({success:0,failed:0}),o=new Set(s.map(v=>v.asset_id.toLowerCase())),y=v=>{const g=v.trim().split(`
`);if(g.length<2)return[];const _=g[0].split(",").map(M=>M.trim().toLowerCase().replace(/['"]/g,""));return g.slice(1).map(M=>{const A=M.split(",").map(T=>T.trim().replace(/^["']|["']$/g,"")),S={};_.forEach((T,B)=>{S[T]=A[B]||""});const c=[],p=S.asset_id||S["asset id"]||S.id||"",w=S.name||S["equipment name"]||S.equipment||"";p||c.push("Missing Asset ID"),w||c.push("Missing Name");const E=o.has(p.toLowerCase());return E&&c.push("Duplicate Asset ID"),{asset_id:p,name:w,category:S.category||S.type||"General",condition:S.condition||"Good",notes:S.notes||S.description||"",test_tag_done_date:S.test_tag_done_date||S.last_test||S["last test"]||"",test_tag_next_due:S.test_tag_next_due||S.next_test||S["next test"]||"",qr_code:S.qr_code||S.qr||"",isValid:c.length===0,errors:c,isDuplicate:E}})},a=v=>{var M;const g=(M=v.target.files)==null?void 0:M[0];if(!g)return;const _=new FileReader;_.onload=A=>{var p;const S=(p=A.target)==null?void 0:p.result,c=y(S);h(c),m("preview")},_.readAsText(g)},d=async()=>{const v=C.filter(M=>M.isValid);if(v.length===0)return;m("importing");let g=0,_=0;for(let M=0;M<v.length;M++){const A=v[M];try{await x({asset_id:A.asset_id,qr_code:A.qr_code||`QR-${A.asset_id}`,name:A.name,category:A.category,condition:A.condition,notes:A.notes,test_tag_done_date:A.test_tag_done_date||null,test_tag_next_due:A.test_tag_next_due||null,current_status:"Available",tag_threshold_days:30})?g++:_++}catch{_++}L((M+1)/v.length*100)}b({success:g,failed:_}),m("done")},j=C.filter(v=>v.isValid).length,f=C.filter(v=>!v.isValid).length;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`${k.card} w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${k.divider} flex items-center justify-between`,children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Import Equipment"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[u==="upload"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{onClick:()=>{var v;return(v=i.current)==null?void 0:v.click()},className:"border-2 border-dashed border-white/20 rounded-xl p-12 text-center cursor-pointer hover:border- hover:bg-blue-50/30 transition-all",children:[e.jsx("svg",{className:"w-12 h-12 text-white/20 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),e.jsx("p",{className:"text-sm font-medium text-slate-200 mb-1",children:"Click to upload CSV file"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Supports .csv files"})]}),e.jsx("input",{ref:i,type:"file",accept:".csv,.txt",onChange:a,className:"hidden"}),e.jsxs("div",{className:"bg-slate-900/40 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Expected CSV Format"}),e.jsxs("code",{className:"text-xs text-slate-300 block bg-slate-900/40 p-3 rounded border border-white/10 font-mono",children:["asset_id,name,category,condition,notes,test_tag_done_date,test_tag_next_due",e.jsx("br",{}),"TT-0025,Makita Drill,Power Tools,Good,Heavy duty,2026-01-15,2026-07-15"]})]})]}),u==="preview"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 text-emerald-700 rounded-lg text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),j," valid"]}),f>0&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-700 rounded-lg text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),f," invalid"]})]}),e.jsx("div",{className:"border border-white/10 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto max-h-64",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-900/40 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-400",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-400",children:"Asset ID"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-400",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-400",children:"Category"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-400",children:"Issues"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:C.map((v,g)=>e.jsxs("tr",{className:v.isValid?"":"bg-red-50/50",children:[e.jsx("td",{className:"px-3 py-2",children:v.isValid?e.jsx("span",{className:"w-5 h-5 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})})}):e.jsx("span",{className:"w-5 h-5 rounded-full bg-red-100 text-red-600 flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})}),e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:v.asset_id||"-"}),e.jsx("td",{className:"px-3 py-2",children:v.name||"-"}),e.jsx("td",{className:"px-3 py-2 text-slate-400",children:v.category}),e.jsx("td",{className:"px-3 py-2 text-xs text-red-500",children:v.errors.join(", ")})]},g))})]})})})]}),u==="importing"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("svg",{className:"animate-spin w-12 h-12 text- mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-sm font-medium text-white mb-2",children:"Importing equipment..."}),e.jsx("div",{className:"w-64 mx-auto h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg- rounded-full transition-all",style:{width:`${l}%`}})}),e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:[Math.round(l),"%"]})]}),u==="done"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{className:"text-lg font-bold text-white mb-1",children:"Import Complete"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[N.success," imported successfully",N.failed>0&&`, ${N.failed} failed`]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-white/10 flex items-center justify-end gap-3",children:[u==="upload"&&e.jsx("button",{onClick:t,className:"px-4 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-slate-900/40",children:"Cancel"}),u==="preview"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{m("upload"),h([])},className:"px-4 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-slate-900/40",children:"Back"}),e.jsxs("button",{onClick:d,disabled:j===0,className:"px-4 py-2.5 bg-amber-500/90 text-slate-950 rounded-lg text-sm font-semibold hover:bg-amber-500 disabled:opacity-50",children:["Import ",j," Items"]})]}),u==="done"&&e.jsx("button",{onClick:()=>{n(),t()},className:"px-4 py-2.5 bg-amber-500/90 text-slate-950 rounded-lg text-sm font-semibold hover:bg-amber-500",children:"Done"})]})]})})}function te({onClose:t}){const{signIn:n,signUp:x,error:s,clearError:i,isLoading:u}=U(),[m,C]=r.useState("signin"),[h,l]=r.useState({email:"",password:"",fullName:"",role:"standard"}),[L,N]=r.useState(""),b=async y=>{if(y.preventDefault(),N(""),i(),!h.email||!h.password){N("Email and password are required");return}if(m==="signup"&&!h.fullName){N("Full name is required");return}m==="signin"?await n(h.email,h.password):await x(h.email,h.password,h.fullName,h.role)},o=L||s;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`${k.card} w-full max-w-md overflow-hidden`,children:[e.jsx("div",{className:"px-6 py-5 bg-slate-900/60 text-white border-b border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:m==="signin"?"Welcome Back":"Create Account"}),e.jsx("p",{className:"text-sm text-white/70 mt-0.5",children:m==="signin"?"Sign in to your account":"Set up your new account"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:b,className:"p-6 space-y-4",children:[o&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3 text-sm text-red-300 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),o]}),m==="signup"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:h.fullName,onChange:y=>l(a=>({...a,fullName:y.target.value})),placeholder:"John Smith",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none ${k.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:h.email,onChange:y=>l(a=>({...a,email:y.target.value})),placeholder:"you@company.com",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none ${k.input}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:h.password,onChange:y=>l(a=>({...a,password:y.target.value})),placeholder:"Enter password",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none ${k.input}`})]}),m==="signup"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-200 mb-1",children:"Role"}),e.jsxs("select",{value:h.role,onChange:y=>l(a=>({...a,role:y.target.value})),className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:outline-none ${k.input}`,children:[e.jsx("option",{value:"standard",children:"Standard User (Read-only)"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full px-4 py-2.5 bg-amber-500/90 text-slate-950 rounded-lg text-sm font-semibold hover:bg-amber-500 transition-colors disabled:opacity-50",children:u?"Processing...":m==="signin"?"Sign In":"Create Account"}),e.jsxs("p",{className:"text-center text-sm text-slate-400",children:[m==="signin"?"Don't have an account? ":"Already have an account? ",e.jsx("button",{type:"button",onClick:()=>{C(m==="signin"?"signup":"signin"),i(),N("")},className:"text- font-medium hover:underline",children:m==="signin"?"Sign Up":"Sign In"})]})]})]})})}function Ne({message:t,type:n,onClose:x,duration:s=4e3}){r.useEffect(()=>{const m=setTimeout(x,s);return()=>clearTimeout(m)},[x,s]);const i={success:"bg-emerald-600",error:"bg-red-600",info:"bg-slate-800/70 backdrop-blur-md"},u={success:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),error:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),info:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})};return e.jsx("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in",children:e.jsxs("div",{className:`${i[n]} text-white rounded-xl shadow-lg px-4 py-3 flex items-center gap-3 min-w-[300px]`,children:[u[n],e.jsx("p",{className:"text-sm font-medium flex-1",children:t}),e.jsx("button",{onClick:x,className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})})}function ke(){const[t,n]=r.useState("dashboard"),[x,s]=r.useState(!1),[i,u]=r.useState(!1),[m,C]=r.useState(),[h,l]=r.useState(!1),[L,N]=r.useState(!1),[b,o]=r.useState(!1),[y,a]=r.useState(!1),[d,j]=r.useState(null),[f,v]=r.useState(null),{selectedEquipment:g,selectEquipment:_,refreshData:M,equipment:A}=R(),{isAuthenticated:S,isLoading:c}=U(),p=r.useCallback(($,q="success")=>{v({message:$,type:q})},[]),w=r.useCallback(($,q)=>{n($),C(q||void 0),u(!1)},[]),E=r.useCallback($=>{_($),n("detail"),u(!1)},[_]),T=r.useCallback(()=>{_(null),n("equipment")},[_]),B=r.useCallback(()=>{a(!1),N(!0)},[]),F=r.useCallback(()=>{a(!0),N(!0)},[]),Q=r.useCallback($=>{j($)},[]),ne=r.useCallback(()=>{N(!1),p(y?"Equipment updated successfully":"Equipment created successfully"),M()},[y,p,M]),ae=r.useCallback(()=>{o(!1),p("Equipment imported successfully"),M()},[p,M]),le=r.useCallback(()=>{j(null),p("Movement recorded successfully"),M()},[p,M]),G=r.useCallback($=>{const q=($||"").trim();if(!q)return;const O=A.find(P=>P.qr_code&&P.qr_code.toLowerCase()===q.toLowerCase()||P.asset_id&&P.asset_id.toLowerCase()===q.toLowerCase());O?(_(O.id),n("detail"),p(`Navigated to ${O.name} (${O.asset_id})`,"success"),u(!1)):p(`No equipment found for QR code: ${q}`,"error")},[A,_,p]),J=r.useCallback(()=>{if(window.matchMedia&&window.matchMedia("(min-width: 768px)").matches){s($=>!$);return}u($=>!$)},[]);return c?e.jsx("div",{className:`min-h-screen flex items-center justify-center text-slate-300 ${k.shell}`,children:"Loading"}):S?e.jsxs("div",{className:`min-h-screen ${k.shell}`,children:[i&&e.jsx("div",{className:"fixed inset-0 z-30 bg-black/50 md:hidden",onClick:()=>u(!1)}),e.jsx("div",{className:`md:hidden fixed inset-y-0 left-0 z-40 transition-transform duration-300 ${i?"translate-x-0":"-translate-x-full"}`,children:e.jsx(X,{currentView:t,onNavigate:w,collapsed:!1,onToggle:()=>u(!1)})}),e.jsxs("div",{className:"hidden md:flex min-h-screen",children:[e.jsx(X,{currentView:t,onNavigate:w,collapsed:x,onToggle:()=>s($=>!$)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(K,{onOpenAuth:()=>l(!0),currentView:t,onScanResult:G,onToggleSidebar:J}),e.jsxs("div",{className:"p-4 lg:p-6",children:[t==="dashboard"&&e.jsx(Y,{onNavigate:w}),t==="equipment"&&e.jsx(Z,{onSelectEquipment:E,onCreateNew:B,onImport:()=>o(!0),initialFilter:m}),t==="detail"&&e.jsx(ee,{onBack:T,onEdit:F,onMovement:Q})]})]})]}),e.jsxs("div",{className:"md:hidden",children:[e.jsx(K,{onOpenAuth:()=>l(!0),currentView:t,onScanResult:G,onToggleSidebar:J}),e.jsxs("div",{className:"p-4",children:[t==="dashboard"&&e.jsx(Y,{onNavigate:w}),t==="equipment"&&e.jsx(Z,{onSelectEquipment:E,onCreateNew:B,onImport:()=>o(!0),initialFilter:m}),t==="detail"&&e.jsx(ee,{onBack:T,onEdit:F,onMovement:Q})]})]}),h&&e.jsx(te,{onClose:()=>l(!1)}),L&&e.jsx(je,{equipment:y?g:null,onClose:()=>N(!1),onSuccess:ne}),d&&g&&e.jsx(ve,{type:d,equipment:g,onClose:()=>j(null),onSuccess:le}),b&&e.jsx(we,{onClose:()=>o(!1),onSuccess:ae}),f&&e.jsx(Ne,{message:f.message,type:f.type,onClose:()=>v(null)})]}):e.jsx("div",{className:`min-h-screen flex items-center justify-center ${k.shell}`,children:e.jsx(te,{onClose:()=>{}})})}function ye(){return e.jsx(de,{children:e.jsx(ue,{children:e.jsx(ke,{})})})}const _e={sidebarOpen:!1,toggleSidebar:()=>{}},Ce=r.createContext(_e),Le=({children:t})=>{const[n,x]=r.useState(!1),s=()=>{x(i=>!i)};return e.jsx(Ce.Provider,{value:{sidebarOpen:n,toggleSidebar:s},children:t})},Ae=()=>e.jsx(Le,{children:e.jsx(ye,{})});export{Ae as default};
