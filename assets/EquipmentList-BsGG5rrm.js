import{r as A,R as L,j as e,U as l}from"./index-D2wEAUMB.js";import{u as C,b as M,c as b,a as w,n as S}from"./Index-thqiWSAH.js";import{S as k,T as y,g as $}from"./StatusBadge-Dco8OKUD.js";import"./supabase-DllM73rC.js";import"./Settings-DvgwgW1l.js";const B=["All","Available","In Use","Overdue","Repair","Expired Tags","Due Soon"];function N(t){return t==="Repair"?"Action Required":t}function H({onSelectEquipment:t,onCreateNew:c,onImport:u,initialFilter:s}){const{filteredEquipment:a,searchQuery:o,setSearchQuery:m,activeFilter:d,setActiveFilter:x,stats:i,isLoading:g,movements:j}=C(),{isAdmin:h}=M(),[p,f]=A.useState("grid");L.useEffect(()=>{s&&x(s)},[s,x]);const _={All:i.total,Available:i.available,"In Use":i.inUse,Overdue:i.overdue,Repair:i.repair,"Expired Tags":i.expiredTags,"Due Soon":i.dueSoon};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:`px-6 py-4 ${l.card} ${l.cardPad} space-y-4`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),e.jsx("input",{type:"text",value:o,onChange:r=>m(r.target.value),placeholder:"Search equipment, asset ID, category...",className:`w-full pl-10 pr-4 py-2.5 rounded-lg text-sm focus:outline-none border ${l.input}`}),o&&e.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center bg-slate-900/30 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>f("grid"),className:`p-2 rounded-md transition-all ${p==="grid"?"bg-slate-800/60 ring-1 ring-white/10 text-white":"text-slate-400"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})})}),e.jsx("button",{onClick:()=>f("table"),className:`p-2 rounded-md transition-all ${p==="table"?"bg-slate-800/60 ring-1 ring-white/10 text-white":"text-slate-400"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z"})})})]}),h&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:u,className:"px-3 py-2.5 border border-white/10 rounded-lg text-sm font-medium text-slate-200 hover:bg-slate-900/40 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),"Import"]}),e.jsxs("button",{onClick:c,className:"px-4 py-2.5 bg-amber-500/90 text-slate-950 rounded-lg text-sm font-semibold hover:bg-amber-500 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Add Equipment"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto pb-1",children:B.map(r=>e.jsxs("button",{onClick:()=>x(r),className:`px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap transition-all ${d===r?"bg-amber-500/25 text-amber-200 ring-1 ring-amber-400/20":"text-slate-400 hover:text-slate-200 hover:bg-slate-900/30"}`,children:[N(r),e.jsx("span",{className:`ml-1.5 text-xs ${d===r?"text-white/70":"text-slate-400"}`,children:_[r]})]},N(r)))})]}),d==="Repair"&&e.jsxs("div",{className:`${l.card} ${l.cardPad} mt-4`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Action Required"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Showing ",a.length," items"]})]}),e.jsx("div",{className:"mt-3 divide-y divide-slate-700/40",children:a.slice(0,6).map(r=>{const n=j.find(v=>v.equipment_id===r.id&&v.event_type==="return");return n?e.jsxs("div",{className:"py-2 flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm text-foreground/90 truncate",children:r.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Returned by ",e.jsx("span",{className:"text-foreground/85 font-medium",children:n.assigned_to||"-"}),n.event_timestamp?` â€¢ ${new Date(n.event_timestamp).toLocaleDateString("en-AU")}`:""]}),(n.issue_description||n.notes)&&e.jsx("p",{className:"text-xs text-muted-foreground/80 line-clamp-2 mt-1",children:n.issue_description||n.notes})]}),e.jsx("button",{onClick:()=>t(r.id),className:"text-xs text-muted-foreground hover:text-foreground/90 transition-colors whitespace-nowrap",children:"Open"})]},r.id):null})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[g?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[...Array(6)].map((r,n)=>e.jsxs("div",{className:"bg-slate-800/50 rounded-2xl p-5 ring-1 ring-white/5 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-white/10 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-white/10 rounded w-1/2 mb-4"}),e.jsx("div",{className:"h-6 bg-white/10 rounded w-20"})]},n))}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400",children:[e.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})}),e.jsx("p",{className:"text-lg font-medium mb-1",children:"No equipment found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filter criteria"})]}):p==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:a.map(r=>e.jsx(D,{equipment:r,onClick:()=>t(r.id),isAdmin:h,lastReturn:j.find(n=>n.equipment_id===r.id&&n.event_type==="return")},r.id))}):e.jsx(T,{equipment:a,onSelect:t,isAdmin:h}),!g&&a.length>0&&e.jsxs("p",{className:"text-xs text-slate-400 mt-4 text-center",children:["Showing ",a.length," of ",i.total," items"]})]})]})}function D({equipment:t,onClick:c,isAdmin:u,lastReturn:s}){const a=b(t),o=w(t),m=S(a),d=$(m),x=d.barClass,i=d.label;return e.jsxs("button",{onClick:c,className:`p-0 text-left group w-full ${l.card} ${l.cardHover}`,children:[e.jsx("div",{className:`llt-card-statusbar ${x}`,children:e.jsx("span",{className:"llt-card-statusbar__label",children:i})}),e.jsxs("div",{className:"llt-pad-md",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-mono text-muted-foreground bg-background/60 px-1.5 py-0.5 rounded",children:t.asset_id}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.category})]}),e.jsx("h3",{className:"llt-h3 llt-text-strong truncate group-hover:opacity-90 transition-colors",children:t.name})]}),e.jsx("svg",{className:"w-4 h-4 text-muted-foreground/70 group-hover:text-muted-foreground flex-shrink-0 mt-1 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(k,{status:a}),e.jsx(y,{state:o})]}),a==="Repair"&&s&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-border/70 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Returned by"}),e.jsx("span",{className:"text-foreground/85 font-medium truncate",children:s.assigned_to||"-"})]}),(s.issue_description||s.notes)&&e.jsx("p",{className:"text-xs text-muted-foreground/80 line-clamp-2",children:s.issue_description||s.notes})]}),t.test_tag_next_due&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Next test: ",new Date(t.test_tag_next_due).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})]}),a!=="Available"&&t.assigned_to&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-border/70 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),e.jsx("span",{className:"text-foreground/85 font-medium",children:t.assigned_to})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("svg",{className:"w-3.5 h-3.5 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3.75 0 11-6 0 3 3.75 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),e.jsx("span",{className:"text-muted-foreground",children:t.assigned_site})]}),t.expected_return_date&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5"})}),e.jsxs("span",{className:`${new Date(t.expected_return_date)<new Date?"llt-error-text font-medium":"text-muted-foreground"}`,children:["Due: ",new Date(t.expected_return_date).toLocaleDateString("en-AU",{day:"numeric",month:"short"})]})]})]})]})]})}function T({equipment:t,onSelect:c,isAdmin:u}){return e.jsx("div",{className:`overflow-hidden ${l.card}`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b ${l.divider}`,children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Asset"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Tag"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Assigned To"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Site"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Next Test"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:t.map(s=>{const a=b(s),o=w(s);return e.jsxs("tr",{onClick:()=>c(s.id),className:"hover:bg-slate-900/40 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.name}),e.jsx("p",{className:"text-xs text-slate-400 font-mono",children:s.asset_id})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-300",children:s.category}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(k,{status:a})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(y,{state:o})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-300",children:s.assigned_to||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-300",children:s.assigned_site||"-"}),e.jsx("td",{className:"px-4 py-3 text-xs text-slate-400",children:s.test_tag_next_due?new Date(s.test_tag_next_due).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"}):"-"})]},s.id)})})]})})})}export{H as default};
