import{a as j,r as a,j as e,U as s}from"./index-DKL_nJHR.js";import{s as m}from"./supabase-DllM73rC.js";function N(){const p=j(),[x,h]=a.useState(!1),[f,i]=a.useState(!1),[r,w]=a.useState(""),[d,y]=a.useState(""),[o,n]=a.useState(null),[c,u]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const{data:t}=await m.auth.getSession();i(!!t.session)}catch{i(!1)}finally{h(!0)}})()},[]);const b=async l=>{if(l.preventDefault(),n(null),!r||r.length<8){n("Password must be at least 8 characters.");return}if(r!==d){n("Passwords do not match.");return}u(!0);try{const{error:t}=await m.auth.updateUser({password:r});if(t)throw t;n("Password updated. You can now sign in."),setTimeout(()=>p("/"),800)}catch(t){n((t==null?void 0:t.message)||"Failed to update password.")}finally{u(!1)}};return x?f?e.jsx("div",{className:`min-h-screen flex items-center justify-center p-6 ${s.shell}`,children:e.jsxs("form",{onSubmit:b,className:`${s.card} ${s.cardPad} max-w-md w-full space-y-4`,children:[e.jsx("h1",{className:"llt-h2",children:"Set a new password"}),o&&e.jsx("div",{className:`text-sm rounded-lg border ${s.divider} llt-surface-2 px-3 py-2`,children:o}),e.jsxs("div",{children:[e.jsx("label",{className:`block llt-label mb-1 ${s.textSubtle}`,children:"New password"}),e.jsx("input",{type:"password",value:r,onChange:l=>w(l.target.value),className:`w-full px-3 py-2.5 rounded-lg text-sm border ${s.input}`,placeholder:"At least 8 characters",autoComplete:"new-password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block llt-label mb-1 ${s.textSubtle}`,children:"Confirm new password"}),e.jsx("input",{type:"password",value:d,onChange:l=>y(l.target.value),className:`w-full px-3 py-2.5 rounded-lg text-sm border ${s.input}`,placeholder:"Repeat password",autoComplete:"new-password"})]}),e.jsx("button",{type:"submit",disabled:c,className:"w-full px-4 py-2.5 rounded-lg text-sm font-semibold bg-primary text-primary-foreground hover:opacity-95 transition-opacity disabled:opacity-50",children:c?"Updating�":"Update password"})]})}):e.jsx("div",{className:`min-h-screen flex items-center justify-center p-6 ${s.shell}`,children:e.jsxs("div",{className:`${s.card} ${s.cardPad} max-w-md w-full`,children:[e.jsx("h1",{className:"llt-h2",children:"Reset link expired or invalid"}),e.jsx("p",{className:`llt-body-sm mt-2 ${s.textMuted}`,children:"Request a new password reset email and open it immediately."}),e.jsx("a",{href:"/long-line-tracker-v2/#/",className:"inline-flex mt-4 text-sm font-medium underline underline-offset-4 text-primary hover:opacity-90",children:"Back to sign in"})]})}):e.jsx("div",{className:`min-h-screen flex items-center justify-center ${s.shell}`,children:e.jsx("div",{className:`${s.card} ${s.cardPad}`,children:e.jsx("div",{className:`llt-body-sm ${s.textMuted}`,children:"Loading�"})})})}export{N as default};
