import{a as w,r as t,j as e}from"./index-CXMtpIWm.js";import{s as u}from"./supabase-DllM73rC.js";function v(){const m=w(),[f,x]=t.useState(!1),[p,o]=t.useState(!1),[r,g]=t.useState(""),[l,h]=t.useState(""),[i,n]=t.useState(null),[d,c]=t.useState(!1);t.useEffect(()=>{(async()=>{try{const{data:s}=await u.auth.getSession();o(!!s.session)}catch{o(!1)}finally{x(!0)}})()},[]);const b=async a=>{if(a.preventDefault(),n(null),!r||r.length<8){n("Password must be at least 8 characters.");return}if(r!==l){n("Passwords do not match.");return}c(!0);try{const{error:s}=await u.auth.updateUser({password:r});if(s)throw s;n("Password updated. You can now sign in."),setTimeout(()=>m("/"),800)}catch(s){n((s==null?void 0:s.message)||"Failed to update password.")}finally{c(!1)}};return f?p?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f8f9fb] p-6",children:e.jsxs("form",{onSubmit:b,className:"bg-white border border-gray-200 rounded-2xl p-6 max-w-md w-full space-y-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Set a new password"}),i&&e.jsx("div",{className:"text-sm rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-gray-800",children:i}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New password"}),e.jsx("input",{type:"password",value:r,onChange:a=>g(a.target.value),className:"w-full px-3 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[#1e3a5f]/20 focus:border-[#1e3a5f]",placeholder:"At least 8 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm new password"}),e.jsx("input",{type:"password",value:l,onChange:a=>h(a.target.value),className:"w-full px-3 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[#1e3a5f]/20 focus:border-[#1e3a5f]",placeholder:"Repeat password"})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full px-4 py-2.5 bg-[#1e3a5f] text-white rounded-lg text-sm font-medium hover:bg-[#2d5a8e] transition-colors disabled:opacity-50",children:d?"Updating…":"Update password"})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f8f9fb] p-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 max-w-md w-full",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Reset link expired or invalid"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Request a new password reset email and open it immediately."}),e.jsx("a",{href:"/long-line-tracker-v2/#/",className:"inline-block mt-4 text-sm font-medium text-[#1e3a5f] underline",children:"Back to sign in"})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-600",children:"Loading…"})}export{v as default};
