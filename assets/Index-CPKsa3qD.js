const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-Dxc844yS.js","assets/index-Dp5AHC-w.js","assets/index-BJJ_DCuR.css","assets/supabase-DllM73rC.js","assets/Settings-DoPy-T8b.js","assets/EquipmentList-DRk448ki.js","assets/StatusBadge-56NJXYNz.js","assets/EquipmentDetail-DV9ybhT5.js","assets/EquipmentForm-B4zHRMFY.js","assets/MovementForm-CK4HY5_9.js","assets/ImportModal-BhUDH6Dr.js","assets/AuthModal-PtP7UrMF.js"])))=>i.map(i=>d[i]);
import{r as t,j as e,U as z,_ as M}from"./index-Dp5AHC-w.js";import{s as h}from"./supabase-DllM73rC.js";import Y from"./Settings-DoPy-T8b.js";const B=t.createContext(null);async function Z(n){const{data:i,error:o}=await h.from("profiles").select("*").eq("user_id",n).maybeSingle();if(o)throw o;return i??null}function ee({children:n}){const[i,o]=t.useState({user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!0,error:null}),d=t.useRef(null),l=t.useRef(null),f=t.useRef(!0),g=t.useCallback(()=>{d.current=null,l.current=null,f.current&&o({user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!1,error:null})},[]),w=t.useCallback(m=>{f.current&&o({user:m,isAuthenticated:!0,isAdmin:m.role==="admin",isLoading:!1,error:null})},[]),x=t.useCallback(async m=>{if(d.current===m&&l.current)return l.current;d.current=m;const b=(async()=>{try{return await Z(m)}catch(u){return console.error("Profile fetch error:",u),null}})();return l.current=b,b},[]);t.useEffect(()=>{f.current=!0;const m=async u=>{var y,C;if(!((y=u==null?void 0:u.user)!=null&&y.id)){g();return}if(!f.current)return;o(S=>({...S,isLoading:!0,error:null}));const p=u.user.id,k=await x(p);f.current&&d.current===p&&w(k||{id:p,user_id:p,email:u.user.email||"",full_name:((C=u.user.user_metadata)==null?void 0:C.full_name)||u.user.email||"",role:"standard",created_at:new Date().toISOString()})};h.auth.getSession().then(({data:u})=>{m(u.session)});const{data:{subscription:b}}=h.auth.onAuthStateChange((u,p)=>{m(p)});return()=>{f.current=!1,b.unsubscribe()}},[x,w,g]);const c=t.useCallback(async(m,b)=>{o(p=>({...p,isLoading:!0,error:null}));const{error:u}=await h.auth.signInWithPassword({email:m,password:b});u&&o(p=>({...p,isLoading:!1,error:u.message}))},[]),A=t.useCallback(async(m,b,u,p="standard")=>{var C;o(S=>({...S,isLoading:!0,error:null}));const{data:k,error:y}=await h.auth.signUp({email:m,password:b,options:{data:{full_name:u}}});if(y){o(S=>({...S,isLoading:!1,error:y.message}));return}(C=k.user)!=null&&C.id&&await h.from("profiles").upsert({user_id:k.user.id,email:m,full_name:u,role:p})},[]),v=t.useCallback(async()=>{await h.auth.signOut()},[]),q=t.useCallback(()=>{o(m=>({...m,error:null}))},[]);return e.jsx(B.Provider,{value:{...i,signIn:c,signUp:A,signOut:v,clearError:q},children:n})}function $(){const n=t.useContext(B);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}function te(n){if(!n.test_tag_next_due)return"No Tag";const i=new Date,o=new Date(n.test_tag_next_due),d=Math.ceil((o.getTime()-i.getTime())/(1e3*60*60*24));return d<0?"Expired":d<=n.tag_threshold_days?"Due Soon":"OK"}function re(n){return n==="Maintenance"?"Repair":n}function se(n){const i=re(n.current_status);if(i==="Repair"||i==="Expired"||i==="Overdue")return i;if(i==="In Use"){if(n.expected_return_date){const o=new Date;if(new Date(n.expected_return_date)<o)return"Overdue"}return"In Use"}return"Available"}function ye(n){switch(n){case"OK":return{bg:"bg-card/60",text:"llt-text-success",border:"llt-border-success"};case"Due Soon":return{bg:"bg-card/60",text:"llt-text-warning",border:"llt-border-warning"};case"Expired":return{bg:"bg-card/60",text:"text-destructive",border:"border-destructive/35"};case"No Tag":return{bg:"bg-card/60",text:"text-muted-foreground",border:"border-border/60"}}}const Se=["Power Tools","Survey Equipment","Compaction","Power Supply","Cutting Equipment","Fastening Tools","Demolition","Electrical Testing","Access Equipment","General","Safety Equipment","Hand Tools"],W=t.createContext(null);function D(n,i){const o=n.toLowerCase(),d=i.toLowerCase();if(o.includes(d))return!0;let l=0;for(let f=0;f<o.length&&l<d.length;f++)o[f]===d[l]&&l++;return l===d.length}function ne({children:n}){const[i,o]=t.useState([]),[d,l]=t.useState([]),[f,g]=t.useState(!0),[w,x]=t.useState(null),[c,A]=t.useState(""),[v,q]=t.useState("All"),[m,b]=t.useState(null),u=t.useCallback(async()=>{g(!0),x(null);const r=new AbortController,s=setTimeout(()=>r.abort(),12e3);try{const[a,j]=await Promise.all([h.from("equipment").select("*").order("asset_id",{ascending:!0}).abortSignal(r.signal),h.from("movements").select("*").order("event_timestamp",{ascending:!1}).abortSignal(r.signal)]);if(clearTimeout(s),a.error)throw a.error;if(j.error)throw j.error;const U=(a.data||[]).map(T=>{const O=se(T),V=te(T);return{...T,current_status:O,_derived_status:O,_derived_tag:V}});o(U),l(j.data||[])}catch(a){a.name==="AbortError"?x("Request timed out. Please try again."):x(a.message||"Failed to load data")}finally{g(!1)}},[]);t.useEffect(()=>{u()},[u]);const p=t.useMemo(()=>{const r={total:0,available:0,inUse:0,overdue:0,expiredTags:0,dueSoon:0};return i.forEach(s=>{r.total++;const a=s._derived_status;a==="Available"&&r.available++,a==="In Use"&&r.inUse++,a==="Overdue"&&r.overdue++;const j=s._derived_tag;j==="Expired"&&r.expiredTags++,j==="Due Soon"&&r.dueSoon++}),r},[i]),k=t.useMemo(()=>{let r=i;switch(v){case"Available":r=r.filter(s=>s._derived_status==="Available");break;case"In Use":r=r.filter(s=>s._derived_status==="In Use");break;case"Overdue":r=r.filter(s=>s._derived_status==="Overdue");break;case"Expired Tags":r=r.filter(s=>s._derived_tag==="Expired");break;case"Due Soon":r=r.filter(s=>s._derived_tag==="Due Soon");break}return c.trim()&&(r=r.filter(s=>D(s.name,c)||D(s.asset_id,c)||D(s.category,c)||D(s.assigned_to||"",c)||D(s.assigned_site||"",c))),r},[i,v,c]),y=t.useMemo(()=>m&&i.find(r=>r.id===m)||null,[m,i]),C=t.useMemo(()=>m?d.filter(r=>r.equipment_id===m):[],[m,d]),S=t.useCallback(r=>{b(r)},[]),N=t.useCallback(async r=>{try{const{data:s,error:a}=await h.from("equipment").insert(r).select().single();if(a)throw a;return await u(),s}catch(s){return console.error("[createEquipment] failed",s),x((s==null?void 0:s.message)||"Create failed"),null}},[u]),L=t.useCallback(async(r,s)=>{try{const{error:a}=await h.from("equipment").update({...s,updated_at:new Date().toISOString()}).eq("id",r);if(a)throw a;return await u(),!0}catch(a){return x(a.message),!1}},[u]),I=t.useCallback(async r=>{try{const{error:s}=await h.from("movements").insert(r);if(s)throw s;const a={};if(r.event_type==="check_out"?(a.current_status="In Use",a.assigned_to=r.assigned_to||"",a.assigned_site=r.site||"",a.assigned_job=r.job_reference||"",a.expected_return_date=r.expected_return_date||null):r.event_type==="return"&&(a.current_status="Available",a.assigned_to="",a.assigned_site="",a.assigned_job="",a.expected_return_date=null),r.equipment_id){const{error:j}=await h.from("equipment").update({...a,updated_at:new Date().toISOString()}).eq("id",r.equipment_id);if(j)throw j}return await u(),!0}catch(s){return x(s.message),!1}},[u]),P=t.useCallback(async(r,s)=>{try{const{error:a}=await h.storage.from("equipment-photos").upload(s,r,{upsert:!0});if(a)throw a;const{data:j}=h.storage.from("equipment-photos").getPublicUrl(s);return j.publicUrl}catch(a){return console.error("[createEquipment] failed",a),x((a==null?void 0:a.message)||"Create failed"),null}},[]);return e.jsx(W.Provider,{value:{equipment:i,movements:d,isLoading:f,error:w,searchQuery:c,activeFilter:v,filteredEquipment:k,stats:p,selectedEquipment:y,selectedMovements:C,setSearchQuery:A,setActiveFilter:q,selectEquipment:S,refreshData:u,createEquipment:N,updateEquipment:L,createMovement:I,uploadPhoto:P},children:n})}function H(){const n=t.useContext(W);if(!n)throw new Error("useEquipment must be used within EquipmentProvider");return n}function ae({onOpenAuth:n,currentView:i,onScanResult:o,onToggleSidebar:d}){var v;const{user:l,isAdmin:f,setDemoRole:g,signOut:w}=$(),[x,c]=t.useState(!1),A={dashboard:"Dashboard",equipment:"Equipment Registry",detail:"Equipment Detail"};return e.jsx("header",{className:"sticky top-0 z-20 llt-nav-shell",children:e.jsxs("div",{className:"px-4 lg:px-6 h-16 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{type:"button","aria-label":"Open menu",onClick:()=>d==null?void 0:d(),className:"lg:hidden inline-flex items-center justify-center rounded-lg border border-input llt-surface-2 p-2 text-foreground/80 llt-nav-item",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("h1",{className:"text-lg font-semibold truncate",children:A[i]||"Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{type:"button",className:"hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-semibold bg-primary text-primary-foreground hover:opacity-95 transition-opacity",onClick:()=>{},children:"Scan QR"}),e.jsxs("div",{className:"hidden md:flex items-center rounded-lg p-0.5 border border-input bg-card/60",children:[e.jsx("button",{type:"button",onClick:()=>g("admin"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-colors ${f?"bg-accent text-accent-foreground":"text-muted-foreground hover:text-foreground"}`,children:"Admin"}),e.jsx("button",{type:"button",onClick:()=>g("standard"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-colors ${f?"text-muted-foreground hover:text-foreground":"bg-accent text-accent-foreground"}`,children:"Standard"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>c(q=>!q),className:"flex items-center gap-2 rounded-lg px-2 py-1.5 llt-nav-item",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent text-accent-foreground flex items-center justify-center text-sm font-semibold",children:((v=l==null?void 0:l.full_name)==null?void 0:v.charAt(0))||"U"}),e.jsx("span",{className:"hidden lg:block text-sm text-muted-foreground",children:(l==null?void 0:l.full_name)||"User"})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>c(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-56 z-40 overflow-hidden rounded-xl border border-border/60 llt-overlay-panel text-popover-foreground ",children:[e.jsxs("div",{className:`px-4 py-3 border-b ${z.divider}`,children:[e.jsx("p",{className:"text-sm font-medium",children:l==null?void 0:l.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l==null?void 0:l.email})]}),e.jsx("button",{type:"button",onClick:()=>{n(),c(!1)},className:"w-full text-left px-4 py-2 text-sm llt-nav-item",children:"Account"}),e.jsx("button",{type:"button",onClick:()=>{w(),c(!1)},className:"w-full text-left px-4 py-2 text-sm text-destructive hover:bg-accent transition-colors",children:"Sign Out"})]})]})]})]})]})})}function oe({currentView:n,onNavigate:i,collapsed:o,onToggle:d}){const{stats:l}=H(),f="/long-line-tracker-v2/LLT-developer-logo.png",g=[{id:"dashboard",label:"Dashboard",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})})},{id:"equipment",label:"Equipment",badge:l.total,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17l-5.384-3.19A2.625 2.625 0 015.25 9.75V6.375a2.625 2.625 0 012.786-2.619l5.384.319M11.42 15.17l5.384 3.19A2.625 2.625 0 0017.25 16.5V6.375a2.625 2.625 0 00-2.786-2.619l-5.384.319M11.42 15.17V20.25"})})},,{id:"settings",label:"Settings",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.983 5.25c.425-1.06 1.608-1.06 2.033 0l.314.783a1.125 1.125 0 001.1.72h.823c1.14 0 1.616 1.454.708 2.121l-.666.49a1.125 1.125 0 00-.41 1.257l.254.83c.338 1.104-.9 2.02-1.847 1.364l-.686-.5a1.125 1.125 0 00-1.32 0l-.686.5c-.947.656-2.185-.26-1.847-1.364l.254-.83a1.125 1.125 0 00-.41-1.257l-.666-.49c-.908-.667-.432-2.12.708-2.12h.823a1.125 1.125 0 001.1-.72l.314-.784z"})})}],w=[{label:"Overdue",count:l.overdue,dot:"bg-destructive"},{label:"Expired Tags",count:l.expiredTags,dot:"bg-destructive"},{label:"Due Soon",count:l.dueSoon,dot:"bg-primary"},,{id:"settings",label:"Settings",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.983 5.25c.425-1.06 1.608-1.06 2.033 0l.314.783a1.125 1.125 0 001.1.72h.823c1.14 0 1.616 1.454.708 2.121l-.666.49a1.125 1.125 0 00-.41 1.257l.254.83c.338 1.104-.9 2.02-1.847 1.364l-.686-.5a1.125 1.125 0 00-1.32 0l-.686.5c-.947.656-2.185-.26-1.847-1.364l.254-.83a1.125 1.125 0 00-.41-1.257l-.666-.49c-.908-.667-.432-2.12.708-2.12h.823a1.125 1.125 0 001.1-.72l.314-.784z"})})}],x=c=>n===c||c==="equipment"&&n==="detail";return e.jsxs("aside",{className:[o?"w-16":"w-64","h-screen flex flex-col transition-[width] duration-300","bg-sidebar text-sidebar-foreground border-r border-sidebar-border/70"].join(" "),children:[e.jsxs("div",{className:"h-16 flex items-center gap-3 px-4 border-b border-sidebar-border/70",children:[e.jsx("img",{src:f,alt:"Long Line Tracker",className:"w-10 h-10 object-contain",draggable:!1}),!o&&e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-semibold leading-tight",children:"Long Line"}),e.jsx("div",{className:"text-[10px] text-sidebar-foreground/60 font-medium tracking-wider uppercase",children:"Tracker v2"})]})]}),e.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:g.map(c=>e.jsxs("button",{onClick:()=>i(c.id),title:o?c.label:void 0,className:["w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-colors",x(c.id)?"bg-sidebar-accent text-sidebar-accent-foreground ring-1 ring-sidebar-ring/25":"text-sidebar-foreground/80 hover:text-sidebar-foreground hover:bg-sidebar-accent/60"].join(" "),children:[e.jsx("span",{className:"shrink-0",children:c.icon}),!o&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1 text-left truncate",children:c.label}),typeof c.badge=="number"&&e.jsx("span",{className:"bg-sidebar-accent text-sidebar-accent-foreground text-xs px-2 py-0.5 rounded-full",children:c.badge})]})]},c.id))}),!o&&e.jsx("div",{className:"px-3 pb-4",children:e.jsxs("div",{className:`${z.card} p-3`,children:[e.jsx("p",{className:"text-[10px] font-semibold text-muted-foreground uppercase tracking-wider mb-2",children:"Alerts"}),e.jsx("div",{className:"space-y-2",children:w.map(c=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-foreground/80",children:c.label}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${c.dot}`}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:c.count})]})]},c.label))})]})}),e.jsx("button",{onClick:d,className:"h-12 flex items-center justify-center border-t border-sidebar-border/70 text-sidebar-foreground/80 hover:text-sidebar-foreground hover:bg-sidebar-accent/60 transition-colors",title:o?"Expand":"Collapse",type:"button",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${o?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"})})})]})}function ie({message:n,type:i,onClose:o,duration:d=4e3}){t.useEffect(()=>{const g=setTimeout(o,d);return()=>clearTimeout(g)},[o,d]);const l={success:"bg-emerald-600",error:"bg-red-600",info:"bg-slate-800/70 backdrop-blur-md"},f={success:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),error:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),info:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})};return e.jsx("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in",children:e.jsxs("div",{className:`${l[i]} text-white rounded-xl shadow-lg px-4 py-3 flex items-center gap-3 min-w-[300px]`,children:[f[i],e.jsx("p",{className:"text-sm font-medium flex-1",children:n}),e.jsx("button",{onClick:o,className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})})}const le=t.lazy(()=>M(()=>import("./Dashboard-Dxc844yS.js"),__vite__mapDeps([0,1,2,3,4]))),ce=t.lazy(()=>M(()=>import("./EquipmentList-DRk448ki.js"),__vite__mapDeps([5,1,2,6,3,4]))),ue=t.lazy(()=>M(()=>import("./EquipmentDetail-DV9ybhT5.js"),__vite__mapDeps([7,1,2,6,3,4]))),de=t.lazy(()=>M(()=>import("./EquipmentForm-B4zHRMFY.js"),__vite__mapDeps([8,1,2,3,4]))),me=t.lazy(()=>M(()=>import("./MovementForm-CK4HY5_9.js"),__vite__mapDeps([9,1,2,3,4]))),fe=t.lazy(()=>M(()=>import("./ImportModal-BhUDH6Dr.js"),__vite__mapDeps([10,1,2,3,4]))),pe=t.lazy(()=>M(()=>import("./AuthModal-PtP7UrMF.js"),__vite__mapDeps([11,1,2,3,4])));function xe(){const[n,i]=t.useState("dashboard"),[o,d]=t.useState(!1),[l,f]=t.useState(!1),[g,w]=t.useState(),[x,c]=t.useState(!1),[A,v]=t.useState(!1),[q,m]=t.useState(!1),[b,u]=t.useState(!1),[p,k]=t.useState(null),[y,C]=t.useState(null),{selectedEquipment:S,selectEquipment:N,refreshData:L,equipment:I}=H(),{isAuthenticated:P,isLoading:r}=$(),s=t.useCallback((_,E="success")=>{C({message:_,type:E})},[]),a=t.useCallback((_,E)=>{i(_),w(E||void 0),f(!1)},[]),j=t.useCallback(_=>{N(_),i("detail"),f(!1)},[N]),U=t.useCallback(()=>{N(null),i("equipment")},[N]),T=t.useCallback(()=>{u(!1),v(!0)},[]),O=t.useCallback(()=>{u(!0),v(!0)},[]),V=t.useCallback(_=>{k(_)},[]),Q=t.useCallback(()=>{v(!1),s(b?"Equipment updated successfully":"Equipment created successfully"),L()},[b,s,L]),G=t.useCallback(()=>{m(!1),s("Equipment imported successfully"),L()},[s,L]),K=t.useCallback(()=>{k(null),s("Movement recorded successfully"),L()},[s,L]),J=t.useCallback(_=>{const E=(_||"").trim();if(!E)return;const F=I.find(R=>R.qr_code&&R.qr_code.toLowerCase()===E.toLowerCase()||R.asset_id&&R.asset_id.toLowerCase()===E.toLowerCase());F?(N(F.id),i("detail"),s("Navigated to  ()","success"),f(!1)):s(`No equipment found for QR code: ${E}`,"error")},[I,N,s]);if(r)return e.jsx("div",{className:`min-h-screen flex items-center justify-center text-slate-300 ${z.shell}`,children:"Loadingâ€¦"});if(!P)return e.jsx("div",{className:`min-h-screen flex items-center justify-center ${z.shell}`,children:e.jsx(t.Suspense,{fallback:null,children:e.jsx(pe,{onClose:()=>{}})})});const X=e.jsx("div",{className:"text-slate-400",children:"Loading..."});return e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("div",{className:"hidden md:flex min-h-screen",children:[e.jsx(oe,{currentView:n,onNavigate:a,collapsed:o,onToggle:()=>d(_=>!_)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(ae,{onOpenAuth:()=>c(!0),currentView:n,onScanResult:J,onToggleSidebar:()=>f(_=>!_)}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsxs(t.Suspense,{fallback:X,children:[n==="dashboard"&&e.jsx(le,{onNavigate:a}),n==="equipment"&&e.jsx(ce,{onSelectEquipment:j,onCreateNew:T,onImport:()=>m(!0),initialFilter:g}),n==="detail"&&e.jsx(ue,{onBack:U,onEdit:O,onMovement:V}),n==="settings"&&e.jsx(Y,{})]})})]})]}),e.jsxs(t.Suspense,{fallback:null,children:[A&&e.jsx(de,{equipment:b?S:null,onClose:()=>v(!1),onSuccess:Q}),p&&S&&e.jsx(me,{type:p,equipment:S,onClose:()=>k(null),onSuccess:K}),q&&e.jsx(fe,{onClose:()=>m(!1),onSuccess:G})]}),y&&e.jsx(ie,{message:y.message,type:y.type,onClose:()=>C(null)})]})}function he(){return e.jsx(ee,{children:e.jsx(ne,{children:e.jsx(xe,{})})})}const ge={sidebarOpen:!1,toggleSidebar:()=>{}},be=t.createContext(ge),ve=({children:n})=>{const[i,o]=t.useState(!1),d=()=>{o(l=>!l)};return e.jsx(be.Provider,{value:{sidebarOpen:i,toggleSidebar:d},children:n})},je=()=>e.jsx(ve,{children:e.jsx(he,{})}),Ce=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"}));export{Se as C,Ce as I,$ as a,se as b,te as c,ye as g,re as n,H as u};
