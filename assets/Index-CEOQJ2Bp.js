const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-fKyj7wDH.js","assets/index-CE1kTAX8.js","assets/index-xSiTEoJQ.css","assets/supabase-DllM73rC.js","assets/Settings-Catvnsk6.js","assets/EquipmentList-BWYmOhG6.js","assets/StatusBadge-BX9RRhZ0.js","assets/EquipmentDetail-CUHgE5ew.js","assets/EquipmentForm-Db4ciH5z.js","assets/MovementForm-elTBa8Ci.js","assets/ImportModal-CwK8pr9a.js","assets/AuthModal-BuVksrnb.js"])))=>i.map(i=>d[i]);
import{r as t,j as e,U as z,_ as M}from"./index-CE1kTAX8.js";import{s as h}from"./supabase-DllM73rC.js";import ee from"./Settings-Catvnsk6.js";const B=t.createContext(null);async function te(n){const{data:u,error:o}=await h.from("profiles").select("*").eq("user_id",n).maybeSingle();if(o)throw o;return u??null}function se({children:n}){const[u,o]=t.useState({user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!0,error:null}),d=t.useRef(null),i=t.useRef(null),f=t.useRef(!0),g=t.useCallback(()=>{d.current=null,i.current=null,f.current&&o({user:null,isAuthenticated:!1,isAdmin:!1,isLoading:!1,error:null})},[]),_=t.useCallback(m=>{f.current&&o({user:m,isAuthenticated:!0,isAdmin:m.role==="admin",isLoading:!1,error:null})},[]),p=t.useCallback(async m=>{if(d.current===m&&i.current)return i.current;d.current=m;const b=(async()=>{try{return await te(m)}catch(c){return console.error("Profile fetch error:",c),null}})();return i.current=b,b},[]);t.useEffect(()=>{f.current=!0;const m=async c=>{var y,C;if(!((y=c==null?void 0:c.user)!=null&&y.id)){g();return}if(!f.current)return;o(S=>({...S,isLoading:!0,error:null}));const x=c.user.id,k=await p(x);f.current&&d.current===x&&_(k||{id:x,user_id:x,email:c.user.email||"",full_name:((C=c.user.user_metadata)==null?void 0:C.full_name)||c.user.email||"",role:"standard",created_at:new Date().toISOString()})};h.auth.getSession().then(({data:c})=>{m(c.session)});const{data:{subscription:b}}=h.auth.onAuthStateChange((c,x)=>{m(x)});return()=>{f.current=!1,b.unsubscribe()}},[p,_,g]);const l=t.useCallback(async(m,b)=>{o(x=>({...x,isLoading:!0,error:null}));const{error:c}=await h.auth.signInWithPassword({email:m,password:b});c&&o(x=>({...x,isLoading:!1,error:c.message}))},[]),A=t.useCallback(async(m,b,c,x="standard")=>{var C;o(S=>({...S,isLoading:!0,error:null}));const{data:k,error:y}=await h.auth.signUp({email:m,password:b,options:{data:{full_name:c}}});if(y){o(S=>({...S,isLoading:!1,error:y.message}));return}(C=k.user)!=null&&C.id&&await h.from("profiles").upsert({user_id:k.user.id,email:m,full_name:c,role:x})},[]),v=t.useCallback(async()=>{await h.auth.signOut()},[]),q=t.useCallback(()=>{o(m=>({...m,error:null}))},[]);return e.jsx(B.Provider,{value:{...u,signIn:l,signUp:A,signOut:v,clearError:q},children:n})}function $(){const n=t.useContext(B);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}function V(n){if(!n.test_tag_next_due)return"No Tag";const u=new Date,o=new Date(n.test_tag_next_due),d=Math.ceil((o.getTime()-u.getTime())/(1e3*60*60*24));return d<0?"Expired":d<=n.tag_threshold_days?"Due Soon":"OK"}function T(n){if(n.current_status==="Maintenance")return"Maintenance";if(n.current_status==="In Use"){if(n.expected_return_date){const u=new Date;if(new Date(n.expected_return_date)<u)return"Overdue"}return"In Use"}return"Available"}function ke(n){switch(n){case"OK":return{bg:"bg-card/60",text:"llt-text-success",border:"llt-border-success"};case"Due Soon":return{bg:"bg-card/60",text:"llt-text-warning",border:"llt-border-warning"};case"Expired":return{bg:"bg-card/60",text:"text-destructive",border:"border-destructive/35"};case"No Tag":return{bg:"bg-card/60",text:"text-muted-foreground",border:"border-border/60"}}}function ye(n){switch(n){case"Available":return{bg:"bg-card/60",text:"llt-text-success",dot:"llt-dot-success"};case"In Use":return{bg:"bg-card/60",text:"llt-text-info",dot:"llt-dot-info"};case"Overdue":return{bg:"bg-card/60",text:"text-destructive",dot:"bg-destructive"};case"Maintenance":return{bg:"bg-card/60",text:"llt-text-warning",dot:"llt-dot-warning"}}}const Se=["Power Tools","Survey Equipment","Compaction","Power Supply","Cutting Equipment","Fastening Tools","Demolition","Electrical Testing","Access Equipment","General","Safety Equipment","Hand Tools"],W=t.createContext(null);function D(n,u){const o=n.toLowerCase(),d=u.toLowerCase();if(o.includes(d))return!0;let i=0;for(let f=0;f<o.length&&i<d.length;f++)o[f]===d[i]&&i++;return i===d.length}function re({children:n}){const[u,o]=t.useState([]),[d,i]=t.useState([]),[f,g]=t.useState(!0),[_,p]=t.useState(null),[l,A]=t.useState(""),[v,q]=t.useState("All"),[m,b]=t.useState(null),c=t.useCallback(async()=>{g(!0),p(null);const s=new AbortController,r=setTimeout(()=>s.abort(),12e3);try{const[a,j]=await Promise.all([h.from("equipment").select("*").order("asset_id",{ascending:!0}).abortSignal(s.signal),h.from("movements").select("*").order("event_timestamp",{ascending:!1}).abortSignal(s.signal)]);if(clearTimeout(r),a.error)throw a.error;if(j.error)throw j.error;const U=(a.data||[]).map(O=>({...O,current_status:T(O)}));o(U),i(j.data||[])}catch(a){a.name==="AbortError"?p("Request timed out. Please try again."):p(a.message||"Failed to load data")}finally{g(!1)}},[]);t.useEffect(()=>{c()},[c]);const x=t.useMemo(()=>{const s={total:0,available:0,inUse:0,overdue:0,expiredTags:0,dueSoon:0};return u.forEach(r=>{s.total++;const a=T(r);a==="Available"&&s.available++,a==="In Use"&&s.inUse++,a==="Overdue"&&s.overdue++;const j=V(r);j==="Expired"&&s.expiredTags++,j==="Due Soon"&&s.dueSoon++}),s},[u]),k=t.useMemo(()=>{let s=u;switch(v){case"Available":s=s.filter(r=>T(r)==="Available");break;case"In Use":s=s.filter(r=>T(r)==="In Use");break;case"Overdue":s=s.filter(r=>T(r)==="Overdue");break;case"Expired Tags":s=s.filter(r=>V(r)==="Expired");break;case"Due Soon":s=s.filter(r=>V(r)==="Due Soon");break}return l.trim()&&(s=s.filter(r=>D(r.name,l)||D(r.asset_id,l)||D(r.category,l)||D(r.assigned_to||"",l)||D(r.assigned_site||"",l))),s},[u,v,l]),y=t.useMemo(()=>m&&u.find(s=>s.id===m)||null,[m,u]),C=t.useMemo(()=>m?d.filter(s=>s.equipment_id===m):[],[m,d]),S=t.useCallback(s=>{b(s)},[]),N=t.useCallback(async s=>{try{const{data:r,error:a}=await h.from("equipment").insert(s).select().single();if(a)throw a;return await c(),r}catch(r){return p(r.message),null}},[c]),L=t.useCallback(async(s,r)=>{try{const{error:a}=await h.from("equipment").update({...r,updated_at:new Date().toISOString()}).eq("id",s);if(a)throw a;return await c(),!0}catch(a){return p(a.message),!1}},[c]),I=t.useCallback(async s=>{try{const{error:r}=await h.from("movements").insert(s);if(r)throw r;const a={};if(s.event_type==="check_out"?(a.current_status="In Use",a.assigned_to=s.assigned_to||"",a.assigned_site=s.site||"",a.assigned_job=s.job_reference||"",a.expected_return_date=s.expected_return_date||null):s.event_type==="return"&&(a.current_status="Available",a.assigned_to="",a.assigned_site="",a.assigned_job="",a.expected_return_date=null),s.equipment_id){const{error:j}=await h.from("equipment").update({...a,updated_at:new Date().toISOString()}).eq("id",s.equipment_id);if(j)throw j}return await c(),!0}catch(r){return p(r.message),!1}},[c]),R=t.useCallback(async(s,r)=>{try{const{error:a}=await h.storage.from("equipment-photos").upload(r,s,{upsert:!0});if(a)throw a;const{data:j}=h.storage.from("equipment-photos").getPublicUrl(r);return j.publicUrl}catch(a){return p(a.message),null}},[]);return e.jsx(W.Provider,{value:{equipment:u,movements:d,isLoading:f,error:_,searchQuery:l,activeFilter:v,filteredEquipment:k,stats:x,selectedEquipment:y,selectedMovements:C,setSearchQuery:A,setActiveFilter:q,selectEquipment:S,refreshData:c,createEquipment:N,updateEquipment:L,createMovement:I,uploadPhoto:R},children:n})}function H(){const n=t.useContext(W);if(!n)throw new Error("useEquipment must be used within EquipmentProvider");return n}function ne({onOpenAuth:n,currentView:u,onScanResult:o,onToggleSidebar:d}){var v;const{user:i,isAdmin:f,setDemoRole:g,signOut:_}=$(),[p,l]=t.useState(!1),A={dashboard:"Dashboard",equipment:"Equipment Registry",detail:"Equipment Detail"};return e.jsx("header",{className:"sticky top-0 z-20 llt-nav-shell",children:e.jsxs("div",{className:"px-4 lg:px-6 h-16 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("button",{type:"button","aria-label":"Open menu",onClick:()=>d==null?void 0:d(),className:"lg:hidden inline-flex items-center justify-center rounded-lg border border-input llt-surface-2 p-2 text-foreground/80 llt-nav-item",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("h1",{className:"text-lg font-semibold truncate",children:A[u]||"Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{type:"button",className:"hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-semibold bg-primary text-primary-foreground hover:opacity-95 transition-opacity",onClick:()=>{},children:"Scan QR"}),e.jsxs("div",{className:"hidden md:flex items-center rounded-lg p-0.5 border border-input bg-card/60",children:[e.jsx("button",{type:"button",onClick:()=>g("admin"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-colors ${f?"bg-accent text-accent-foreground":"text-muted-foreground hover:text-foreground"}`,children:"Admin"}),e.jsx("button",{type:"button",onClick:()=>g("standard"),className:`px-2.5 py-1 rounded-md text-xs font-medium transition-colors ${f?"text-muted-foreground hover:text-foreground":"bg-accent text-accent-foreground"}`,children:"Standard"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>l(q=>!q),className:"flex items-center gap-2 rounded-lg px-2 py-1.5 llt-nav-item",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent text-accent-foreground flex items-center justify-center text-sm font-semibold",children:((v=i==null?void 0:i.full_name)==null?void 0:v.charAt(0))||"U"}),e.jsx("span",{className:"hidden lg:block text-sm text-muted-foreground",children:(i==null?void 0:i.full_name)||"User"})]}),p&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-56 z-40 overflow-hidden rounded-xl border border-border/60 llt-overlay-panel text-popover-foreground ",children:[e.jsxs("div",{className:`px-4 py-3 border-b ${z.divider}`,children:[e.jsx("p",{className:"text-sm font-medium",children:i==null?void 0:i.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i==null?void 0:i.email})]}),e.jsx("button",{type:"button",onClick:()=>{n(),l(!1)},className:"w-full text-left px-4 py-2 text-sm llt-nav-item",children:"Account"}),e.jsx("button",{type:"button",onClick:()=>{_(),l(!1)},className:"w-full text-left px-4 py-2 text-sm text-destructive hover:bg-accent transition-colors",children:"Sign Out"})]})]})]})]})]})})}function ae({currentView:n,onNavigate:u,collapsed:o,onToggle:d}){const{stats:i}=H(),f="/long-line-tracker-v2/LLT-developer-logo.png",g=[{id:"dashboard",label:"Dashboard",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})})},{id:"equipment",label:"Equipment",badge:i.total,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17l-5.384-3.19A2.625 2.625 0 015.25 9.75V6.375a2.625 2.625 0 012.786-2.619l5.384.319M11.42 15.17l5.384 3.19A2.625 2.625 0 0017.25 16.5V6.375a2.625 2.625 0 00-2.786-2.619l-5.384.319M11.42 15.17V20.25"})})},,{id:"settings",label:"Settings",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.983 5.25c.425-1.06 1.608-1.06 2.033 0l.314.783a1.125 1.125 0 001.1.72h.823c1.14 0 1.616 1.454.708 2.121l-.666.49a1.125 1.125 0 00-.41 1.257l.254.83c.338 1.104-.9 2.02-1.847 1.364l-.686-.5a1.125 1.125 0 00-1.32 0l-.686.5c-.947.656-2.185-.26-1.847-1.364l.254-.83a1.125 1.125 0 00-.41-1.257l-.666-.49c-.908-.667-.432-2.12.708-2.12h.823a1.125 1.125 0 001.1-.72l.314-.784z"})})}],_=[{label:"Overdue",count:i.overdue,dot:"bg-destructive"},{label:"Expired Tags",count:i.expiredTags,dot:"bg-destructive"},{label:"Due Soon",count:i.dueSoon,dot:"bg-primary"},,{id:"settings",label:"Settings",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.983 5.25c.425-1.06 1.608-1.06 2.033 0l.314.783a1.125 1.125 0 001.1.72h.823c1.14 0 1.616 1.454.708 2.121l-.666.49a1.125 1.125 0 00-.41 1.257l.254.83c.338 1.104-.9 2.02-1.847 1.364l-.686-.5a1.125 1.125 0 00-1.32 0l-.686.5c-.947.656-2.185-.26-1.847-1.364l.254-.83a1.125 1.125 0 00-.41-1.257l-.666-.49c-.908-.667-.432-2.12.708-2.12h.823a1.125 1.125 0 001.1-.72l.314-.784z"})})}],p=l=>n===l||l==="equipment"&&n==="detail";return e.jsxs("aside",{className:[o?"w-16":"w-64","h-screen flex flex-col transition-[width] duration-300","bg-sidebar text-sidebar-foreground border-r border-sidebar-border/70"].join(" "),children:[e.jsxs("div",{className:"h-16 flex items-center gap-3 px-4 border-b border-sidebar-border/70",children:[e.jsx("img",{src:f,alt:"Long Line Tracker",className:"w-10 h-10 object-contain",draggable:!1}),!o&&e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-semibold leading-tight",children:"Long Line"}),e.jsx("div",{className:"text-[10px] text-sidebar-foreground/60 font-medium tracking-wider uppercase",children:"Tracker v2"})]})]}),e.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:g.map(l=>e.jsxs("button",{onClick:()=>u(l.id),title:o?l.label:void 0,className:["w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-colors",p(l.id)?"bg-sidebar-accent text-sidebar-accent-foreground ring-1 ring-sidebar-ring/25":"text-sidebar-foreground/80 hover:text-sidebar-foreground hover:bg-sidebar-accent/60"].join(" "),children:[e.jsx("span",{className:"shrink-0",children:l.icon}),!o&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1 text-left truncate",children:l.label}),typeof l.badge=="number"&&e.jsx("span",{className:"bg-sidebar-accent text-sidebar-accent-foreground text-xs px-2 py-0.5 rounded-full",children:l.badge})]})]},l.id))}),!o&&e.jsx("div",{className:"px-3 pb-4",children:e.jsxs("div",{className:`${z.card} p-3`,children:[e.jsx("p",{className:"text-[10px] font-semibold text-muted-foreground uppercase tracking-wider mb-2",children:"Alerts"}),e.jsx("div",{className:"space-y-2",children:_.map(l=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-foreground/80",children:l.label}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${l.dot}`}),e.jsx("span",{className:"text-xs font-semibold tabular-nums",children:l.count})]})]},l.label))})]})}),e.jsx("button",{onClick:d,className:"h-12 flex items-center justify-center border-t border-sidebar-border/70 text-sidebar-foreground/80 hover:text-sidebar-foreground hover:bg-sidebar-accent/60 transition-colors",title:o?"Expand":"Collapse",type:"button",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${o?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"})})})]})}function oe({message:n,type:u,onClose:o,duration:d=4e3}){t.useEffect(()=>{const g=setTimeout(o,d);return()=>clearTimeout(g)},[o,d]);const i={success:"bg-emerald-600",error:"bg-red-600",info:"bg-slate-800/70 backdrop-blur-md"},f={success:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),error:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),info:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})};return e.jsx("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in",children:e.jsxs("div",{className:`${i[u]} text-white rounded-xl shadow-lg px-4 py-3 flex items-center gap-3 min-w-[300px]`,children:[f[u],e.jsx("p",{className:"text-sm font-medium flex-1",children:n}),e.jsx("button",{onClick:o,className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})})}const ie=t.lazy(()=>M(()=>import("./Dashboard-fKyj7wDH.js"),__vite__mapDeps([0,1,2,3,4]))),le=t.lazy(()=>M(()=>import("./EquipmentList-BWYmOhG6.js"),__vite__mapDeps([5,1,2,6,3,4]))),ce=t.lazy(()=>M(()=>import("./EquipmentDetail-CUHgE5ew.js"),__vite__mapDeps([7,1,2,6,3,4]))),ue=t.lazy(()=>M(()=>import("./EquipmentForm-Db4ciH5z.js"),__vite__mapDeps([8,1,2,3,4]))),de=t.lazy(()=>M(()=>import("./MovementForm-elTBa8Ci.js"),__vite__mapDeps([9,1,2,3,4]))),me=t.lazy(()=>M(()=>import("./ImportModal-CwK8pr9a.js"),__vite__mapDeps([10,1,2,3,4]))),fe=t.lazy(()=>M(()=>import("./AuthModal-BuVksrnb.js"),__vite__mapDeps([11,1,2,3,4])));function xe(){const[n,u]=t.useState("dashboard"),[o,d]=t.useState(!1),[i,f]=t.useState(!1),[g,_]=t.useState(),[p,l]=t.useState(!1),[A,v]=t.useState(!1),[q,m]=t.useState(!1),[b,c]=t.useState(!1),[x,k]=t.useState(null),[y,C]=t.useState(null),{selectedEquipment:S,selectEquipment:N,refreshData:L,equipment:I}=H(),{isAuthenticated:R,isLoading:s}=$(),r=t.useCallback((w,E="success")=>{C({message:w,type:E})},[]),a=t.useCallback((w,E)=>{u(w),_(E||void 0),f(!1)},[]),j=t.useCallback(w=>{N(w),u("detail"),f(!1)},[N]),U=t.useCallback(()=>{N(null),u("equipment")},[N]),O=t.useCallback(()=>{c(!1),v(!0)},[]),Q=t.useCallback(()=>{c(!0),v(!0)},[]),G=t.useCallback(w=>{k(w)},[]),K=t.useCallback(()=>{v(!1),r(b?"Equipment updated successfully":"Equipment created successfully"),L()},[b,r,L]),J=t.useCallback(()=>{m(!1),r("Equipment imported successfully"),L()},[r,L]),X=t.useCallback(()=>{k(null),r("Movement recorded successfully"),L()},[r,L]),Y=t.useCallback(w=>{const E=(w||"").trim();if(!E)return;const F=I.find(P=>P.qr_code&&P.qr_code.toLowerCase()===E.toLowerCase()||P.asset_id&&P.asset_id.toLowerCase()===E.toLowerCase());F?(N(F.id),u("detail"),r("Navigated to  ()","success"),f(!1)):r(`No equipment found for QR code: ${E}`,"error")},[I,N,r]);if(s)return e.jsx("div",{className:`min-h-screen flex items-center justify-center text-slate-300 ${z.shell}`,children:"Loadingâ€¦"});if(!R)return e.jsx("div",{className:`min-h-screen flex items-center justify-center ${z.shell}`,children:e.jsx(t.Suspense,{fallback:null,children:e.jsx(fe,{onClose:()=>{}})})});const Z=e.jsx("div",{className:"text-slate-400",children:"Loading..."});return e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("div",{className:"hidden md:flex min-h-screen",children:[e.jsx(ae,{currentView:n,onNavigate:a,collapsed:o,onToggle:()=>d(w=>!w)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(ne,{onOpenAuth:()=>l(!0),currentView:n,onScanResult:Y,onToggleSidebar:()=>f(w=>!w)}),e.jsx("div",{className:"p-4 lg:p-6",children:e.jsxs(t.Suspense,{fallback:Z,children:[n==="dashboard"&&e.jsx(ie,{onNavigate:a}),n==="equipment"&&e.jsx(le,{onSelectEquipment:j,onCreateNew:O,onImport:()=>m(!0),initialFilter:g}),n==="detail"&&e.jsx(ce,{onBack:U,onEdit:Q,onMovement:G}),n==="settings"&&e.jsx(ee,{})]})})]})]}),e.jsxs(t.Suspense,{fallback:null,children:[A&&e.jsx(ue,{equipment:b?S:null,onClose:()=>v(!1),onSuccess:K}),x&&S&&e.jsx(de,{type:x,equipment:S,onClose:()=>k(null),onSuccess:X}),q&&e.jsx(me,{onClose:()=>m(!1),onSuccess:J})]}),y&&e.jsx(oe,{message:y.message,type:y.type,onClose:()=>C(null)})]})}function pe(){return e.jsx(se,{children:e.jsx(re,{children:e.jsx(xe,{})})})}const he={sidebarOpen:!1,toggleSidebar:()=>{}},ge=t.createContext(he),be=({children:n})=>{const[u,o]=t.useState(!1),d=()=>{o(i=>!i)};return e.jsx(ge.Provider,{value:{sidebarOpen:u,toggleSidebar:d},children:n})},ve=()=>e.jsx(be,{children:e.jsx(pe,{})}),Ce=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"}));export{Se as C,Ce as I,$ as a,T as b,V as c,ke as d,ye as g,H as u};
